/**
 * Static file content for the frontend
 * Auto-generated by build-static-files.js
 * DO NOT EDIT MANUALLY - Run: node build-static-files.js
 */

export const indexHtml = "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Stock Take Management System</title>\n    <link rel=\"stylesheet\" href=\"/css/style.css\">\n    <!-- QR Code Scanner Library -->\n    <script src=\"https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js\"></script>\n</head>\n<body>\n    <!-- Role Selection Screen (shown first) -->\n    <div id=\"roleSelectionScreen\" class=\"role-selection-screen\">\n        <div class=\"role-selection-card\">\n            <h1>üì¶ Stock Take Management System</h1>\n            <p class=\"subtitle\">Select your role to continue</p>\n            <div class=\"role-options\">\n                <button type=\"button\" class=\"role-option-btn counter-btn\" id=\"counterBtn\">\n                    <div class=\"role-icon\">üì±</div>\n                    <h2>Counter</h2>\n                    <p>Scan and count inventory items</p>\n                </button>\n                <button type=\"button\" class=\"role-option-btn manager-btn\" id=\"managerBtn\">\n                    <div class=\"role-icon\">‚öôÔ∏è</div>\n                    <h2>Manager</h2>\n                    <p>Manage companies, warehouses, and view reports</p>\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Main App (hidden until role selected) -->\n    <div id=\"mainApp\" class=\"container\" style=\"display: none;\">\n        <header>\n            <h1>üì¶ Stock Take Management System</h1>\n            <p class=\"subtitle\" id=\"roleSubtitle\">Scan, count, and submit inventory</p>\n            <button onclick=\"switchRole()\" class=\"btn btn-secondary btn-small\" style=\"margin-top: 10px;\">Switch Role</button>\n        </header>\n\n        <nav class=\"tabs\" id=\"mainTabs\">\n            <button class=\"tab-btn active\" onclick=\"showTab('stocktake', this)\" id=\"stocktakeTabBtn\">Stock Take</button>\n            <button class=\"tab-btn\" onclick=\"showTab('openStockTakes', this)\" id=\"openStockTakesTabBtn\">Open Stock Takes</button>\n            <button class=\"tab-btn\" onclick=\"showTab('setup', this)\" id=\"setupTabBtn\" style=\"display: none;\">Setup</button>\n            <button class=\"tab-btn\" onclick=\"showTab('view', this)\" id=\"viewTabBtn\" style=\"display: none;\">View Items</button>\n        </nav>\n\n        <!-- Open Stock Takes Tab -->\n        <div id=\"openStockTakesTab\" class=\"tab-content\">\n            <div class=\"view-container\">\n                <div class=\"view-header\">\n                    <h2>Open Stock Takes</h2>\n                    <button onclick=\"loadOpenStockTakes()\" class=\"btn btn-secondary\">Refresh</button>\n                </div>\n                <div id=\"openStockTakesList\" class=\"items-list\"></div>\n                <div id=\"noOpenStockTakes\" class=\"no-items\" style=\"display: none;\">No open stock takes found.</div>\n            </div>\n        </div>\n\n        <!-- Setup Tab - Single Company Settings Screen (Manager Only) -->\n        <div id=\"setupTab\" class=\"tab-content\">\n            <div class=\"setup-container\">\n                <!-- Company Selection -->\n                <div class=\"company-selector-section\">\n                    <div class=\"form-group\">\n                        <label for=\"selectedCompany\">Select Company to Configure:</label>\n                        <div class=\"selector-with-button\">\n                            <select id=\"selectedCompany\" class=\"form-control\" onchange=\"onCompanySelected()\">\n                                <option value=\"\">-- Select a Company --</option>\n                            </select>\n                            <button onclick=\"openAddCompanyModal()\" class=\"btn btn-primary\">+ New Company</button>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Company Details (shown when company selected) -->\n                <div id=\"companyDetailsSection\" class=\"setup-section\" style=\"display: none;\">\n                    <div class=\"setup-header\">\n                        <h2 id=\"selectedCompanyName\">Company Setup</h2>\n                        <button onclick=\"editSelectedCompany()\" class=\"btn btn-secondary\">Edit Company</button>\n                    </div>\n\n                    <!-- Warehouses Section -->\n                    <div class=\"setup-subsection\">\n                        <div class=\"subsection-header\">\n                            <h3>Warehouses</h3>\n                            <button onclick=\"openAddWarehouseModal()\" class=\"btn btn-primary btn-small\">+ Add Warehouse</button>\n                        </div>\n                        <div id=\"warehousesList\" class=\"items-list\"></div>\n                        <div id=\"noWarehouses\" class=\"no-items\" style=\"display: none;\">No warehouses found. Add a warehouse to get started.</div>\n                    </div>\n\n                    <!-- Bin Locations Section -->\n                    <div class=\"setup-subsection\">\n                        <div class=\"subsection-header\">\n                            <h3>Bin Locations</h3>\n                            <button onclick=\"openAddBinLocationModal()\" class=\"btn btn-primary btn-small\">+ Add Bin Location</button>\n                        </div>\n                        <div class=\"filter-box\">\n                            <label>Filter by Warehouse:</label>\n                            <select id=\"binLocationWarehouseFilter\" onchange=\"loadBinLocationsForCompany()\">\n                                <option value=\"\">All Warehouses</option>\n                            </select>\n                        </div>\n                        <div id=\"binLocationsList\" class=\"items-list\"></div>\n                        <div id=\"noBinLocations\" class=\"no-items\" style=\"display: none;\">No bin locations found. Add a bin location to get started.</div>\n                    </div>\n\n                    <!-- Managers Section -->\n                    <div class=\"setup-subsection\">\n                        <div class=\"subsection-header\">\n                            <h3>Warehouse Managers</h3>\n                            <button onclick=\"openAddManagerModal()\" class=\"btn btn-primary btn-small\">+ Add Manager</button>\n                        </div>\n                        <div class=\"filter-box\">\n                            <label>Filter by Warehouse:</label>\n                            <select id=\"managerWarehouseFilter\" onchange=\"loadManagersForCompany()\">\n                                <option value=\"\">All Warehouses</option>\n                            </select>\n                        </div>\n                        <div id=\"managersList\" class=\"items-list\"></div>\n                        <div id=\"noManagers\" class=\"no-items\" style=\"display: none;\">No managers found. Add a manager to get started.</div>\n                    </div>\n                </div>\n\n                <!-- All Companies List (shown when no company selected) -->\n                <div id=\"allCompaniesSection\" class=\"setup-section\">\n                    <div class=\"setup-header\">\n                        <h2>All Companies</h2>\n                        <button onclick=\"openAddCompanyModal()\" class=\"btn btn-primary\">+ Add Company</button>\n                    </div>\n                    <div id=\"companiesList\" class=\"items-list\"></div>\n                    <div id=\"noCompanies\" class=\"no-items\" style=\"display: none;\">No companies found. Create your first company to get started.</div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Stock Take Tab - NEW WORKFLOW -->\n        <div id=\"stocktakeTab\" class=\"tab-content active\">\n            <div class=\"stock-take-workflow\">\n                <!-- Counter Mode: Simple Start Counting -->\n                <section class=\"workflow-section\" id=\"counterStartSection\" style=\"display: none;\">\n                    <h2>üì± Start Counting</h2>\n                    <div class=\"start-counting-container\">\n                        <p class=\"start-hint\">Scan a bin location to begin counting</p>\n                        <div class=\"scan-input-large\">\n                            <label for=\"counterBinLocationInput\" class=\"scan-label\">Bin Location Code</label>\n                            <p class=\"scan-hint\">Scan QR code or enter bin code</p>\n                            <div class=\"input-with-button-large\">\n                                <input \n                                    type=\"text\" \n                                    id=\"counterBinLocationInput\" \n                                    class=\"form-control scan-input\" \n                                    placeholder=\"Scan or enter bin code to start...\"\n                                    onkeypress=\"if(event.key==='Enter') handleCounterBinLocationScan()\"\n                                    autocomplete=\"off\"\n                                    autofocus\n                                >\n                                <button onclick=\"startQRScan('counterBinLocationInput')\" class=\"btn btn-secondary btn-large\" title=\"Scan QR Code\">üì∑</button>\n                                <button onclick=\"handleCounterBinLocationScan()\" class=\"btn btn-primary btn-large\">Start</button>\n                            </div>\n                        </div>\n                    </div>\n                </section>\n\n                <!-- Manager Mode: Open/Close Stock Take -->\n                <section class=\"workflow-section\" id=\"managerStockTakeSection\" style=\"display: none;\">\n                    <h2>1. Manage Stock Take</h2>\n                    <div id=\"stockTakeStatus\" class=\"status-box\">\n                        <p>No stock take open</p>\n                    </div>\n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"openStockTakeCompany\">Company *</label>\n                            <select id=\"openStockTakeCompany\" class=\"form-control\" required onchange=\"updateWarehousesForOpenStockTake()\">\n                                <option value=\"\">Select Company</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"openStockTakeWarehouse\">Warehouse *</label>\n                            <select id=\"openStockTakeWarehouse\" class=\"form-control\" required onchange=\"validateManagerForWarehouse()\">\n                                <option value=\"\">Select Warehouse</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div id=\"managerValidationMessage\" class=\"validation-message\" style=\"display: none;\"></div>\n                    <div class=\"button-group\">\n                        <button onclick=\"openStockTake()\" class=\"btn btn-primary\" id=\"openStockTakeBtn\">Open Stock Take</button>\n                        <button onclick=\"closeStockTake()\" class=\"btn btn-danger\" id=\"closeStockTakeBtn\" style=\"display: none;\">Close Stock Take</button>\n                    </div>\n                </section>\n\n                <!-- Step 2: Scan Bin Location -->\n                <section class=\"workflow-section scanning-section\" id=\"binLocationSection\" style=\"display: none;\">\n                    <h2>üì¶ Scan Bin Location</h2>\n                    <div id=\"currentBinLocation\" class=\"current-bin-box\" style=\"display: none;\">\n                        <h3>Current Bin: <span id=\"currentBinCode\"></span></h3>\n                        <p id=\"currentBinInfo\"></p>\n                    </div>\n                    <div class=\"scanning-container\">\n                        <div class=\"scan-input-large\">\n                            <label for=\"binLocationInput\" class=\"scan-label\">Bin Location Code</label>\n                            <p class=\"scan-hint\">Scan QR code or type bin code</p>\n                            <div class=\"input-with-button-large\">\n                                <input \n                                    type=\"text\" \n                                    id=\"binLocationInput\" \n                                    class=\"form-control scan-input\" \n                                    placeholder=\"Scan or enter bin code...\"\n                                    onkeypress=\"if(event.key==='Enter') handleBinLocationScan()\"\n                                    autocomplete=\"off\"\n                                    autofocus\n                                >\n                                <button onclick=\"startQRScan('binLocationInput')\" class=\"btn btn-secondary btn-large\" title=\"Scan QR Code\">üì∑</button>\n                                <button onclick=\"handleBinLocationScan()\" class=\"btn btn-primary btn-large\">‚úì Scan</button>\n                            </div>\n                            <button onclick=\"clearBinLocation()\" class=\"btn btn-link\" id=\"clearBinBtn\" style=\"display: none; margin-top: 10px;\">Clear Bin Location</button>\n                        </div>\n                    </div>\n                </section>\n\n                <!-- Step 3: Scan Items -->\n                <section class=\"workflow-section scanning-section\" id=\"itemScanSection\" style=\"display: none;\">\n                    <h2>üì± Scan Items</h2>\n                    <div class=\"scanning-container\">\n                        <div class=\"scan-input-large\">\n                            <label for=\"itemCodeInput\" class=\"scan-label\">Item Code</label>\n                            <p class=\"scan-hint\">Scan QR code for item</p>\n                            <div class=\"input-with-button-large\">\n                                <input \n                                    type=\"text\" \n                                    id=\"itemCodeInput\" \n                                    class=\"form-control scan-input\" \n                                    placeholder=\"Scan QR code or enter item code...\"\n                                    onkeypress=\"if(event.key==='Enter') handleItemCodeScan()\"\n                                    autocomplete=\"off\"\n                                    autofocus\n                                >\n                                <button onclick=\"startQRScan('itemCodeInput')\" class=\"btn btn-secondary btn-large\" title=\"Scan QR Code\">üì∑</button>\n                            </div>\n                        </div>\n                        \n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"itemNameInput\">Item Name (Optional)</label>\n                                <input \n                                    type=\"text\" \n                                    id=\"itemNameInput\" \n                                    class=\"form-control\" \n                                    placeholder=\"Auto-filled or enter manually\"\n                                >\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"itemQuantityInput\">Quantity *</label>\n                                <input \n                                    type=\"number\" \n                                    id=\"itemQuantityInput\" \n                                    class=\"form-control\" \n                                    min=\"0\" \n                                    value=\"0\"\n                                    required\n                                >\n                            </div>\n                        </div>\n                        \n                        <div class=\"button-group-center\">\n                            <button onclick=\"addItemToBin()\" class=\"btn btn-primary btn-large\">+ Add Item to Bin</button>\n                        </div>\n                    </div>\n                </section>\n\n                <!-- Step 4: Items in Current Bin -->\n                <section class=\"workflow-section\" id=\"binItemsSection\" style=\"display: none;\">\n                    <h2>üìã Items in Current Bin</h2>\n                    <div id=\"binItemsList\" class=\"items-list\"></div>\n                    <div id=\"noBinItems\" class=\"no-items\" style=\"display: none;\">No items added yet. Scan items above.</div>\n                    <div class=\"button-group-center\" style=\"margin-top: 20px;\">\n                        <button onclick=\"submitBinLocation()\" class=\"btn btn-success btn-large\" id=\"submitBinBtn\">‚úÖ Submit Bin Location</button>\n                        <button onclick=\"clearBinItems()\" class=\"btn btn-secondary\">Clear All Items</button>\n                    </div>\n                </section>\n            </div>\n        </div>\n\n        <!-- View Items Tab (Manager Only) -->\n        <div id=\"viewTab\" class=\"tab-content\">\n            <div class=\"view-container\">\n                <div class=\"view-header\">\n                    <h2>Stock Items</h2>\n                    <button onclick=\"loadItems()\" class=\"btn btn-secondary\">Refresh</button>\n                </div>\n                <div class=\"search-box\">\n                    <input\n                        type=\"text\"\n                        id=\"searchStockInput\"\n                        placeholder=\"Search items by name, code, or notes...\"\n                        class=\"search-input\"\n                        oninput=\"handleStockSearch()\"\n                    >\n                </div>\n                <div id=\"loadingStock\" class=\"loading\" style=\"display: none;\">\n                    <div class=\"spinner\"></div>\n                    <p>Loading items...</p>\n                </div>\n                <div id=\"errorStock\" class=\"error\" style=\"display: none;\"></div>\n                <div id=\"stockItemsContainer\" class=\"items-container\">\n                    <div id=\"stockItemsList\" class=\"items-list\">\n                        <!-- Stock items will be loaded here -->\n                    </div>\n                </div>\n                <div id=\"noStockItems\" class=\"no-items\" style=\"display: none;\">No stock items found.</div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Modals for Setup -->\n    <!-- Company Modals -->\n    <div id=\"addCompanyModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeAddCompanyModal()\">&times;</span>\n            <h2>Add Company</h2>\n            <form onsubmit=\"handleAddCompany(event)\">\n                <div class=\"form-group\">\n                    <label>Company Code *</label>\n                    <input type=\"text\" id=\"addCompanyCode\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Company Name *</label>\n                    <input type=\"text\" id=\"addCompanyName\" class=\"form-control\" required>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Add Company</button>\n            </form>\n        </div>\n    </div>\n\n    <div id=\"editCompanyModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeEditCompanyModal()\">&times;</span>\n            <h2>Edit Company</h2>\n            <form onsubmit=\"handleEditCompany(event)\">\n                <input type=\"hidden\" id=\"editCompanyId\">\n                <div class=\"form-group\">\n                    <label>Company Code *</label>\n                    <input type=\"text\" id=\"editCompanyCode\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Company Name *</label>\n                    <input type=\"text\" id=\"editCompanyName\" class=\"form-control\" required>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Update Company</button>\n            </form>\n        </div>\n    </div>\n\n    <!-- Warehouse Modals -->\n    <div id=\"addWarehouseModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeAddWarehouseModal()\">&times;</span>\n            <h2>Add Warehouse</h2>\n            <form onsubmit=\"handleAddWarehouse(event)\">\n                <div class=\"form-group\">\n                    <label>Company *</label>\n                    <select id=\"addWarehouseCompany\" class=\"form-control\" required>\n                        <option value=\"\">Select Company</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Warehouse Code *</label>\n                    <input type=\"text\" id=\"addWarehouseCode\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Warehouse Name *</label>\n                    <input type=\"text\" id=\"addWarehouseName\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Address</label>\n                    <textarea id=\"addWarehouseAddress\" class=\"form-control\" rows=\"2\"></textarea>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Add Warehouse</button>\n            </form>\n        </div>\n    </div>\n\n    <div id=\"editWarehouseModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeEditWarehouseModal()\">&times;</span>\n            <h2>Edit Warehouse</h2>\n            <form onsubmit=\"handleEditWarehouse(event)\">\n                <input type=\"hidden\" id=\"editWarehouseId\">\n                <div class=\"form-group\">\n                    <label>Company *</label>\n                    <select id=\"editWarehouseCompany\" class=\"form-control\" required>\n                        <option value=\"\">Select Company</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Warehouse Code *</label>\n                    <input type=\"text\" id=\"editWarehouseCode\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Warehouse Name *</label>\n                    <input type=\"text\" id=\"editWarehouseName\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Address</label>\n                    <textarea id=\"editWarehouseAddress\" class=\"form-control\" rows=\"2\"></textarea>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Update Warehouse</button>\n            </form>\n        </div>\n    </div>\n\n    <!-- Bin Location Modals -->\n    <div id=\"addBinLocationModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeAddBinLocationModal()\">&times;</span>\n            <h2>Add Bin Location</h2>\n            <form onsubmit=\"handleAddBinLocation(event)\">\n                <div class=\"form-group\">\n                    <label>Warehouse *</label>\n                    <select id=\"addBinLocationWarehouse\" class=\"form-control\" required>\n                        <option value=\"\">Select Warehouse</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Bin Code *</label>\n                    <input type=\"text\" id=\"addBinLocationCode\" class=\"form-control\" required placeholder=\"e.g., A-01-02-03\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Bin Name</label>\n                    <input type=\"text\" id=\"addBinLocationName\" class=\"form-control\">\n                </div>\n                <div class=\"form-row\">\n                    <div class=\"form-group\">\n                        <label>Aisle</label>\n                        <input type=\"text\" id=\"addBinLocationAisle\" class=\"form-control\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Shelf</label>\n                        <input type=\"text\" id=\"addBinLocationShelf\" class=\"form-control\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Level</label>\n                        <input type=\"text\" id=\"addBinLocationLevel\" class=\"form-control\">\n                    </div>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Add Bin Location</button>\n            </form>\n        </div>\n    </div>\n\n    <div id=\"editBinLocationModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeEditBinLocationModal()\">&times;</span>\n            <h2>Edit Bin Location</h2>\n            <form onsubmit=\"handleEditBinLocation(event)\">\n                <input type=\"hidden\" id=\"editBinLocationId\">\n                <div class=\"form-group\">\n                    <label>Warehouse *</label>\n                    <select id=\"editBinLocationWarehouse\" class=\"form-control\" required>\n                        <option value=\"\">Select Warehouse</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Bin Code *</label>\n                    <input type=\"text\" id=\"editBinLocationCode\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Bin Name</label>\n                    <input type=\"text\" id=\"editBinLocationName\" class=\"form-control\">\n                </div>\n                <div class=\"form-row\">\n                    <div class=\"form-group\">\n                        <label>Aisle</label>\n                        <input type=\"text\" id=\"editBinLocationAisle\" class=\"form-control\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Shelf</label>\n                        <input type=\"text\" id=\"editBinLocationShelf\" class=\"form-control\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Level</label>\n                        <input type=\"text\" id=\"editBinLocationLevel\" class=\"form-control\">\n                    </div>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Update Bin Location</button>\n            </form>\n        </div>\n    </div>\n\n    <!-- Manager Modals -->\n    <div id=\"addManagerModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeAddManagerModal()\">&times;</span>\n            <h2>Add Manager</h2>\n            <form onsubmit=\"handleAddManager(event)\">\n                <div class=\"form-group\">\n                    <label>Warehouse *</label>\n                    <select id=\"addManagerWarehouse\" class=\"form-control\" required>\n                        <option value=\"\">Select Warehouse</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Manager Name *</label>\n                    <input type=\"text\" id=\"addManagerName\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Email</label>\n                    <input type=\"email\" id=\"addManagerEmail\" class=\"form-control\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Phone</label>\n                    <input type=\"text\" id=\"addManagerPhone\" class=\"form-control\">\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Add Manager</button>\n            </form>\n        </div>\n    </div>\n\n    <div id=\"editManagerModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeEditManagerModal()\">&times;</span>\n            <h2>Edit Manager</h2>\n            <form onsubmit=\"handleEditManager(event)\">\n                <input type=\"hidden\" id=\"editManagerId\">\n                <div class=\"form-group\">\n                    <label>Warehouse *</label>\n                    <select id=\"editManagerWarehouse\" class=\"form-control\" required>\n                        <option value=\"\">Select Warehouse</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label>Manager Name *</label>\n                    <input type=\"text\" id=\"editManagerName\" class=\"form-control\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label>Email</label>\n                    <input type=\"email\" id=\"editManagerEmail\" class=\"form-control\">\n                </div>\n                <div class=\"form-group\">\n                    <label>Phone</label>\n                    <input type=\"text\" id=\"editManagerPhone\" class=\"form-control\">\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary\">Update Manager</button>\n            </form>\n        </div>\n    </div>\n\n    <script src=\"/js/config.js\"></script>\n    <script src=\"/js/app.js\"></script>\n    <script>\n        // Immediate test - verify buttons exist and function is available\n        window.addEventListener('load', function() {\n            console.log('=== PAGE LOADED ===');\n            console.log('selectRole available:', typeof selectRole);\n            console.log('window.selectRole available:', typeof window.selectRole);\n            \n            const counterBtn = document.getElementById('counterBtn');\n            const managerBtn = document.getElementById('managerBtn');\n            console.log('counterBtn:', counterBtn);\n            console.log('managerBtn:', managerBtn);\n            \n            // Test direct click\n            if (counterBtn) {\n                console.log('Counter button exists, adding direct test listener');\n                counterBtn.onclick = function() {\n                    console.log('DIRECT ONCLICK FIRED FOR COUNTER');\n                    if (window.selectRole) {\n                        window.selectRole('counter');\n                    }\n                };\n            }\n            \n            if (managerBtn) {\n                console.log('Manager button exists, adding direct test listener');\n                managerBtn.onclick = function() {\n                    console.log('DIRECT ONCLICK FIRED FOR MANAGER');\n                    if (window.selectRole) {\n                        window.selectRole('manager');\n                    }\n                };\n            }\n        });\n    </script>\n</body>\n</html>\n";

export const configJs = "/**\n * Configuration\n * Uses same domain as frontend - no CORS issues!\n */\n\nconst CONFIG = {\n    // API server URL - Same domain as frontend\n    apiUrl: window.location.origin + '/api',\n};\n\n// Make available globally\nwindow.CONFIG = CONFIG;";

export const appJs = "/**\n * Stock Take Management System\n * Complete warehouse inventory management with company, warehouse, bin location, and manager setup\n */\n\n// Global state\nlet allItems = [];\nlet filteredItems = [];\nlet companies = [];\nlet warehouses = [];\nlet binLocations = [];\nlet managers = [];\nlet currentRole = 'manager'; // 'counter' or 'manager'\n// currentStockTake already declared at top of file\nlet currentBinLocation = null;\nlet currentBinItems = [];\nlet qrScanner = null; // QR Code scanner instance\n\n// Define selectRole function immediately so it's available for onclick handlers\nfunction selectRole(role) {\n    try {\n        console.log('Selecting role:', role);\n        \n        if (!role || (role !== 'counter' && role !== 'manager')) {\n            console.error('Invalid role:', role);\n            return;\n        }\n        \n        localStorage.setItem('stockTakeRole', role);\n        \n        const roleSelectionScreen = document.getElementById('roleSelectionScreen');\n        const mainApp = document.getElementById('mainApp');\n        \n        if (!roleSelectionScreen || !mainApp) {\n            console.error('Required DOM elements not found');\n            alert('Error: Page elements not found. Please refresh the page.');\n            return;\n        }\n        \n        roleSelectionScreen.style.display = 'none';\n        mainApp.style.display = 'block';\n        \n        // Small delay to ensure DOM is ready\n        setTimeout(() => {\n            initializeApp(role);\n        }, 50);\n    } catch (error) {\n        console.error('Error in selectRole:', error);\n        alert('Error selecting role: ' + error.message + '. Please refresh the page and try again.');\n    }\n}\n\n// Make function available globally immediately\nif (typeof window !== 'undefined') {\n    window.selectRole = selectRole;\n    console.log('selectRole function registered on window');\n}\n\n/**\n * Initialize app\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n    console.log('Stock Take Management System initialized');\n    console.log('selectRole function available:', typeof window.selectRole);\n    console.log('selectRole function available (direct):', typeof selectRole);\n    \n    // Add event listeners to role buttons using IDs\n    const counterBtn = document.getElementById('counterBtn');\n    const managerBtn = document.getElementById('managerBtn');\n    \n    console.log('Counter button found:', !!counterBtn);\n    console.log('Manager button found:', !!managerBtn);\n    \n    if (counterBtn) {\n        // Use mousedown as well to catch all interactions\n        ['click', 'mousedown', 'touchstart'].forEach(eventType => {\n            counterBtn.addEventListener(eventType, function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                console.log('Counter button ' + eventType + ' event!');\n                try {\n                    if (typeof selectRole === 'function') {\n                        selectRole('counter');\n                    } else if (typeof window.selectRole === 'function') {\n                        window.selectRole('counter');\n                    } else {\n                        throw new Error('selectRole function not found');\n                    }\n                } catch (error) {\n                    console.error('Error in counter button click:', error);\n                    alert('Error: ' + error.message);\n                }\n            }, { passive: false });\n        });\n        console.log('Counter button event listeners added');\n    } else {\n        console.error('Counter button not found!');\n    }\n    \n    if (managerBtn) {\n        // Use mousedown as well to catch all interactions\n        ['click', 'mousedown', 'touchstart'].forEach(eventType => {\n            managerBtn.addEventListener(eventType, function(e) {\n                e.preventDefault();\n                e.stopPropagation();\n                console.log('Manager button ' + eventType + ' event!');\n                try {\n                    if (typeof selectRole === 'function') {\n                        selectRole('manager');\n                    } else if (typeof window.selectRole === 'function') {\n                        window.selectRole('manager');\n                    } else {\n                        throw new Error('selectRole function not found');\n                    }\n                } catch (error) {\n                    console.error('Error in manager button click:', error);\n                    alert('Error: ' + error.message);\n                }\n            }, { passive: false });\n        });\n        console.log('Manager button event listeners added');\n    } else {\n        console.error('Manager button not found!');\n    }\n    \n    // Check if role is already selected\n    const savedRole = localStorage.getItem('stockTakeRole');\n    \n    if (!savedRole) {\n        // Show role selection screen\n        const roleScreen = document.getElementById('roleSelectionScreen');\n        const mainApp = document.getElementById('mainApp');\n        if (roleScreen) roleScreen.style.display = 'flex';\n        if (mainApp) mainApp.style.display = 'none';\n    } else {\n        // Hide role selection, show main app\n        const roleScreen = document.getElementById('roleSelectionScreen');\n        const mainApp = document.getElementById('mainApp');\n        if (roleScreen) roleScreen.style.display = 'none';\n        if (mainApp) mainApp.style.display = 'block';\n        initializeApp(savedRole);\n    }\n});\n\nfunction initializeApp(role) {\n    try {\n        console.log('Initializing app with role:', role);\n        currentRole = role;\n        \n        // Update UI based on role\n        setRole(role, false); // Don't save (already saved)\n        \n        // Load initial data\n        loadCompanies().then(() => {\n            // After companies load, load other data\n            loadWarehouses();\n            loadBinLocations();\n            loadManagers().then(() => {\n                // After managers load, update company/warehouse dropdowns for stock take\n                updateCompanyDropdowns();\n                updateWarehouseDropdowns();\n            });\n        }).catch(error => {\n            console.error('Error loading initial data:', error);\n        });\n        \n        // Load open stock takes if in counter mode\n        if (role === 'counter') {\n            loadOpenStockTakes();\n        }\n        \n        // Initialize stock take status\n        setTimeout(() => {\n            const stocktakeTab = document.getElementById('stocktakeTab');\n            if (stocktakeTab && stocktakeTab.classList.contains('active')) {\n                updateStockTakeStatus();\n            }\n        }, 100);\n    } catch (error) {\n        console.error('Error in initializeApp:', error);\n        alert('Error initializing app. Please refresh the page and try again.');\n    }\n}\n\n// selectRole function is now defined at the top of the file for immediate availability\n\nfunction switchRole() {\n    if (confirm('Switch to a different role? This will reload the app.')) {\n        localStorage.removeItem('stockTakeRole');\n        location.reload();\n    }\n}\nwindow.switchRole = switchRole;\n\n// ========== ROLE MANAGEMENT ==========\nfunction setRole(role, saveToStorage = true) {\n    currentRole = role;\n    \n    if (saveToStorage) {\n        localStorage.setItem('stockTakeRole', role);\n    }\n    \n    // Update subtitle\n    const subtitle = document.getElementById('roleSubtitle');\n    if (subtitle) {\n        subtitle.textContent = role === 'counter' \n            ? 'Scan, count, and submit inventory' \n            : 'Manage companies, warehouses, and view reports';\n    }\n    \n    // Show/hide tabs based on role\n    const setupTabBtn = document.getElementById('setupTabBtn');\n    const viewTabBtn = document.getElementById('viewTabBtn');\n    const stocktakeTabBtn = document.getElementById('stocktakeTabBtn');\n    const openStockTakesTabBtn = document.getElementById('openStockTakesTabBtn');\n    \n    if (role === 'counter') {\n        // Counter mode: Only show Stock Take and Open Stock Takes tabs (NO SETUP OR VIEW)\n        if (setupTabBtn) setupTabBtn.style.display = 'none';\n        if (viewTabBtn) viewTabBtn.style.display = 'none';\n        if (stocktakeTabBtn) stocktakeTabBtn.style.display = 'inline-block';\n        if (openStockTakesTabBtn) openStockTakesTabBtn.style.display = 'inline-block';\n        \n        // Show counter start section, hide manager section\n        const counterStartSection = document.getElementById('counterStartSection');\n        const managerStockTakeSection = document.getElementById('managerStockTakeSection');\n        if (counterStartSection) counterStartSection.style.display = 'block';\n        if (managerStockTakeSection) managerStockTakeSection.style.display = 'none';\n        \n        // Switch to stock take tab\n        const stocktakeTab = document.getElementById('stocktakeTab');\n        if (stocktakeTab && !stocktakeTab.classList.contains('active')) {\n            try {\n                showTab('stocktake');\n            } catch (error) {\n                console.error('Error switching to stocktake tab:', error);\n            }\n        }\n        \n        // Load open stock takes\n        loadOpenStockTakes();\n        \n        // Focus on counter bin input\n        setTimeout(() => {\n            const counterBinInput = document.getElementById('counterBinLocationInput');\n            if (counterBinInput) counterBinInput.focus();\n        }, 100);\n    } else {\n        // Manager mode: Show all tabs\n        if (setupTabBtn) setupTabBtn.style.display = 'inline-block';\n        if (viewTabBtn) viewTabBtn.style.display = 'inline-block';\n        if (stocktakeTabBtn) stocktakeTabBtn.style.display = 'inline-block';\n        if (openStockTakesTabBtn) openStockTakesTabBtn.style.display = 'inline-block';\n        \n        // Show manager section, hide counter section\n        const counterStartSection = document.getElementById('counterStartSection');\n        const managerStockTakeSection = document.getElementById('managerStockTakeSection');\n        if (counterStartSection) counterStartSection.style.display = 'none';\n        if (managerStockTakeSection) managerStockTakeSection.style.display = 'block';\n    }\n}\nwindow.setRole = setRole;\n\n/**\n * Tab switching\n */\nfunction showTab(tabName, clickedElement) {\n    // Check if tab is allowed for current role\n    if (tabName === 'setup' && currentRole === 'counter') {\n        alert('Setup is only available in Manager mode');\n        return;\n    }\n    if (tabName === 'view' && currentRole === 'counter') {\n        alert('View Items is only available in Manager mode');\n        return;\n    }\n    \n    document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));\n    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));\n    \n    const tabElement = document.getElementById(tabName + 'Tab');\n    if (tabElement) {\n        tabElement.classList.add('active');\n    }\n    \n    if (clickedElement) {\n        clickedElement.classList.add('active');\n    } else {\n        // Find the tab button by ID\n        const tabBtnId = tabName + 'TabBtn';\n        const tabBtn = document.getElementById(tabBtnId);\n        if (tabBtn) {\n            tabBtn.classList.add('active');\n        }\n    }\n    \n    // Load data when switching tabs\n    if (tabName === 'setup') {\n        loadCompanies();\n        // Don't auto-load other data - wait for company selection\n    } else if (tabName === 'stocktake') {\n        // Ensure managers are loaded for validation\n        if (managers.length === 0) {\n            loadManagers();\n        }\n        // Update dropdowns\n        updateCompanyDropdowns();\n        updateWarehouseDropdowns();\n        // Update stock take status\n        updateStockTakeStatus();\n    } else if (tabName === 'view') {\n        loadItems();\n    } else if (tabName === 'openStockTakes') {\n        loadOpenStockTakes();\n    }\n}\nwindow.showTab = showTab;\n\n// ========== COMPANY SELECTION & SETTINGS ==========\nlet selectedCompanyId = null;\n\nfunction onCompanySelected() {\n    const companyId = document.getElementById('selectedCompany').value;\n    selectedCompanyId = companyId ? parseInt(companyId) : null;\n    \n    if (selectedCompanyId) {\n        // Show company details section\n        document.getElementById('companyDetailsSection').style.display = 'block';\n        document.getElementById('allCompaniesSection').style.display = 'none';\n        \n        // Update company name in header\n        const company = companies.find(c => c.id === selectedCompanyId);\n        if (company) {\n            document.getElementById('selectedCompanyName').textContent = company.company_name + ' - Setup';\n        }\n        \n        // Load all data for this company\n        loadWarehousesForCompany();\n        loadBinLocationsForCompany();\n        loadManagersForCompany();\n    } else {\n        // Show all companies list\n        document.getElementById('companyDetailsSection').style.display = 'none';\n        document.getElementById('allCompaniesSection').style.display = 'block';\n        loadCompanies();\n    }\n}\nwindow.onCompanySelected = onCompanySelected;\n\nfunction editSelectedCompany() {\n    if (selectedCompanyId) {\n        openEditCompanyModal(selectedCompanyId);\n    }\n}\nwindow.editSelectedCompany = editSelectedCompany;\n\nfunction selectCompany(companyId) {\n    document.getElementById('selectedCompany').value = companyId;\n    onCompanySelected();\n}\nwindow.selectCompany = selectCompany;\n\n// ========== COMPANIES ==========\nasync function loadCompanies() {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/companies`);\n        companies = await response.json();\n        \n        // Update dropdowns\n        updateCompanyDropdowns();\n        \n        // Update company selector dropdown\n        updateCompanyDropdowns();\n        \n        // Display companies in list (only if no company selected)\n        const listEl = document.getElementById('companiesList');\n        const noCompaniesEl = document.getElementById('noCompanies');\n        if (listEl) {\n            if (companies.length === 0) {\n                listEl.innerHTML = '';\n                if (noCompaniesEl) noCompaniesEl.style.display = 'block';\n            } else {\n                if (noCompaniesEl) noCompaniesEl.style.display = 'none';\n                listEl.innerHTML = companies.map(c => `\n                    <div class=\"item-card\" onclick=\"selectCompany(${c.id})\" style=\"cursor: pointer;\">\n                        <div class=\"item-header\">\n                            <h3>${escapeHtml(c.company_name)}</h3>\n                            <span class=\"item-id\">${escapeHtml(c.company_code)}</span>\n                        </div>\n                        <div class=\"item-details\">\n                            <p>Click to configure this company's warehouses, bin locations, and managers</p>\n                        </div>\n                        <div class=\"item-actions\">\n                            <button onclick=\"event.stopPropagation(); selectCompany(${c.id})\" class=\"btn btn-small\">Configure</button>\n                            <button onclick=\"event.stopPropagation(); editCompany(${c.id})\" class=\"btn btn-small\">Edit</button>\n                            <button onclick=\"event.stopPropagation(); deleteCompany(${c.id})\" class=\"btn btn-small btn-danger\">Delete</button>\n                        </div>\n                    </div>\n                `).join('');\n            }\n        }\n    } catch (error) {\n        console.error('Error loading companies:', error);\n    }\n}\n\nfunction updateCompanyDropdowns() {\n    const selects = document.querySelectorAll('select[id*=\"Company\"], select[id*=\"company\"]');\n    selects.forEach(select => {\n        const currentValue = select.value;\n        const placeholder = select.id === 'selectedCompany' ? '-- Select a Company --' : 'Select Company';\n        select.innerHTML = `<option value=\"\">${placeholder}</option>` + \n            companies.map(c => `<option value=\"${c.id}\">${escapeHtml(c.company_name)}</option>`).join('');\n        if (currentValue) select.value = currentValue;\n    });\n}\n\nfunction openCompanyModal(id = null) {\n    if (id) {\n        openEditCompanyModal(id);\n    } else {\n        openAddCompanyModal();\n    }\n}\nwindow.openCompanyModal = openCompanyModal;\n\nfunction openAddCompanyModal() {\n    document.getElementById('addCompanyModal').style.display = 'flex';\n    document.getElementById('addCompanyCode').value = '';\n    document.getElementById('addCompanyName').value = '';\n}\nwindow.openAddCompanyModal = openAddCompanyModal;\n\nfunction closeAddCompanyModal() {\n    document.getElementById('addCompanyModal').style.display = 'none';\n}\nwindow.closeAddCompanyModal = closeAddCompanyModal;\n\nfunction openEditCompanyModal(id) {\n    const company = companies.find(c => c.id === id);\n    if (!company) return;\n    \n    document.getElementById('editCompanyId').value = id;\n    document.getElementById('editCompanyCode').value = company.company_code;\n    document.getElementById('editCompanyName').value = company.company_name;\n    document.getElementById('editCompanyModal').style.display = 'flex';\n}\nwindow.openEditCompanyModal = openEditCompanyModal;\n\nfunction closeEditCompanyModal() {\n    document.getElementById('editCompanyModal').style.display = 'none';\n}\nwindow.closeEditCompanyModal = closeEditCompanyModal;\n\nasync function handleAddCompany(event) {\n    event.preventDefault();\n    const formData = {\n        company_code: document.getElementById('addCompanyCode').value.trim(),\n        company_name: document.getElementById('addCompanyName').value.trim(),\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/companies`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to save company');\n        \n        const result = await response.json();\n        alert('‚úÖ Company created successfully!');\n        closeAddCompanyModal();\n        await loadCompanies();\n        // Auto-select the newly created company\n        if (result.item && result.item.id) {\n            selectCompany(result.item.id);\n        }\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleAddCompany = handleAddCompany;\n\nasync function handleEditCompany(event) {\n    event.preventDefault();\n    const id = document.getElementById('editCompanyId').value;\n    const formData = {\n        company_code: document.getElementById('editCompanyCode').value.trim(),\n        company_name: document.getElementById('editCompanyName').value.trim(),\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/companies/${id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to update company');\n        \n        alert('‚úÖ Company updated successfully!');\n        closeEditCompanyModal();\n        await loadCompanies();\n        // Keep the same company selected if it still exists\n        if (selectedCompanyId) {\n            document.getElementById('selectedCompany').value = selectedCompanyId;\n            onCompanySelected();\n        }\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleEditCompany = handleEditCompany;\n\nfunction editCompany(id) {\n    openCompanyModal(id);\n}\nwindow.editCompany = editCompany;\n\nasync function deleteCompany(id) {\n    if (!confirm('Are you sure you want to delete this company?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/companies/${id}`, { method: 'DELETE' });\n        if (!response.ok) throw new Error('Failed to delete company');\n        alert('‚úÖ Company deleted successfully!');\n        selectedCompanyId = null;\n        document.getElementById('selectedCompany').value = '';\n        await loadCompanies();\n        onCompanySelected(); // This will show the all companies list\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.deleteCompany = deleteCompany;\n\n// ========== WAREHOUSES ==========\nasync function loadWarehouses() {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/warehouses`);\n        warehouses = await response.json();\n        updateWarehouseDropdowns();\n    } catch (error) {\n        console.error('Error loading warehouses:', error);\n    }\n}\n\nasync function loadWarehousesForCompany() {\n    if (!selectedCompanyId) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/warehouses?company_id=${selectedCompanyId}`);\n        const companyWarehouses = await response.json();\n        \n        const listEl = document.getElementById('warehousesList');\n        const noWarehousesEl = document.getElementById('noWarehouses');\n        \n        if (listEl) {\n            if (companyWarehouses.length === 0) {\n                listEl.innerHTML = '';\n                if (noWarehousesEl) noWarehousesEl.style.display = 'block';\n            } else {\n                if (noWarehousesEl) noWarehousesEl.style.display = 'none';\n                listEl.innerHTML = companyWarehouses.map(w => `\n                    <div class=\"item-card\">\n                        <div class=\"item-header\">\n                            <h3>${escapeHtml(w.warehouse_name)}</h3>\n                            <span class=\"item-id\">${escapeHtml(w.warehouse_code)}</span>\n                        </div>\n                        <div class=\"item-details\">\n                            ${w.address ? `<div class=\"detail-item\"><strong>Address:</strong> ${escapeHtml(w.address)}</div>` : ''}\n                        </div>\n                        <div class=\"item-actions\">\n                            <button onclick=\"editWarehouse(${w.id})\" class=\"btn btn-small\">Edit</button>\n                            <button onclick=\"deleteWarehouse(${w.id})\" class=\"btn btn-small btn-danger\">Delete</button>\n                        </div>\n                    </div>\n                `).join('');\n            }\n        }\n        \n        // Update warehouse filter dropdowns\n        updateWarehouseFilterDropdowns();\n    } catch (error) {\n        console.error('Error loading warehouses for company:', error);\n    }\n}\nwindow.loadWarehousesForCompany = loadWarehousesForCompany;\n\nfunction updateWarehouseDropdowns() {\n    const selects = document.querySelectorAll('select[id*=\"Warehouse\"], select[id*=\"warehouse\"]');\n    selects.forEach(select => {\n        // Skip filter dropdowns - they're updated separately\n        if (select.id === 'binLocationWarehouseFilter' || select.id === 'managerWarehouseFilter') {\n            return;\n        }\n        \n        const currentValue = select.value;\n        let filteredWarehouses = warehouses;\n        \n        // If we have a selected company, filter by it\n        if (selectedCompanyId && select.id !== 'warehouseCompanyFilter') {\n            filteredWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n        }\n        \n        select.innerHTML = '<option value=\"\">Select Warehouse</option>' + \n            filteredWarehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n        if (currentValue) select.value = currentValue;\n    });\n}\n\nfunction updateWarehouseFilterDropdowns() {\n    // Update filter dropdowns with warehouses for selected company\n    const binFilter = document.getElementById('binLocationWarehouseFilter');\n    const managerFilter = document.getElementById('managerWarehouseFilter');\n    \n    const companyWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n    \n    if (binFilter) {\n        const currentValue = binFilter.value;\n        binFilter.innerHTML = '<option value=\"\">All Warehouses</option>' + \n            companyWarehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n        if (currentValue) binFilter.value = currentValue;\n    }\n    \n    if (managerFilter) {\n        const currentValue = managerFilter.value;\n        managerFilter.innerHTML = '<option value=\"\">All Warehouses</option>' + \n            companyWarehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n        if (currentValue) managerFilter.value = currentValue;\n    }\n}\n\nfunction openWarehouseModal(id = null) {\n    if (id) {\n        openEditWarehouseModal(id);\n    } else {\n        openAddWarehouseModal();\n    }\n}\nwindow.openWarehouseModal = openWarehouseModal;\n\nfunction openAddWarehouseModal() {\n    const companySelect = document.getElementById('addWarehouseCompany');\n    companySelect.innerHTML = '<option value=\"\">Select Company</option>' + \n        companies.map(c => `<option value=\"${c.id}\">${escapeHtml(c.company_name)}</option>`).join('');\n    \n    // Pre-select the current company if one is selected\n    if (selectedCompanyId) {\n        companySelect.value = selectedCompanyId;\n    }\n    \n    document.getElementById('addWarehouseCode').value = '';\n    document.getElementById('addWarehouseName').value = '';\n    document.getElementById('addWarehouseAddress').value = '';\n    document.getElementById('addWarehouseModal').style.display = 'flex';\n}\nwindow.openAddWarehouseModal = openAddWarehouseModal;\n\nfunction closeAddWarehouseModal() {\n    document.getElementById('addWarehouseModal').style.display = 'none';\n}\nwindow.closeAddWarehouseModal = closeAddWarehouseModal;\n\nfunction openEditWarehouseModal(id) {\n    const warehouse = warehouses.find(w => w.id === id);\n    if (!warehouse) return;\n    \n    const companySelect = document.getElementById('editWarehouseCompany');\n    companySelect.innerHTML = '<option value=\"\">Select Company</option>' + \n        companies.map(c => `<option value=\"${c.id}\">${escapeHtml(c.company_name)}</option>`).join('');\n    \n    document.getElementById('editWarehouseId').value = id;\n    document.getElementById('editWarehouseCode').value = warehouse.warehouse_code;\n    document.getElementById('editWarehouseName').value = warehouse.warehouse_name;\n    document.getElementById('editWarehouseCompany').value = warehouse.company_id;\n    document.getElementById('editWarehouseAddress').value = warehouse.address || '';\n    document.getElementById('editWarehouseModal').style.display = 'flex';\n}\nwindow.openEditWarehouseModal = openEditWarehouseModal;\n\nfunction closeEditWarehouseModal() {\n    document.getElementById('editWarehouseModal').style.display = 'none';\n}\nwindow.closeEditWarehouseModal = closeEditWarehouseModal;\n\nasync function handleAddWarehouse(event) {\n    event.preventDefault();\n    const formData = {\n        warehouse_code: document.getElementById('addWarehouseCode').value.trim(),\n        warehouse_name: document.getElementById('addWarehouseName').value.trim(),\n        company_id: parseInt(document.getElementById('addWarehouseCompany').value),\n        address: document.getElementById('addWarehouseAddress').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/warehouses`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to save warehouse');\n        \n        alert('‚úÖ Warehouse created successfully!');\n        closeAddWarehouseModal();\n        await loadWarehouses();\n        loadWarehousesForCompany();\n        loadBinLocationsForCompany();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleAddWarehouse = handleAddWarehouse;\n\nasync function handleEditWarehouse(event) {\n    event.preventDefault();\n    const id = document.getElementById('editWarehouseId').value;\n    const formData = {\n        warehouse_code: document.getElementById('editWarehouseCode').value.trim(),\n        warehouse_name: document.getElementById('editWarehouseName').value.trim(),\n        company_id: parseInt(document.getElementById('editWarehouseCompany').value),\n        address: document.getElementById('editWarehouseAddress').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/warehouses/${id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to update warehouse');\n        \n        alert('‚úÖ Warehouse updated successfully!');\n        closeEditWarehouseModal();\n        await loadWarehouses();\n        loadWarehousesForCompany();\n        loadBinLocationsForCompany();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleEditWarehouse = handleEditWarehouse;\n\nfunction editWarehouse(id) {\n    openWarehouseModal(id);\n}\nwindow.editWarehouse = editWarehouse;\n\nasync function deleteWarehouse(id) {\n    if (!confirm('Are you sure you want to delete this warehouse? This will also delete associated bin locations and managers.')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/warehouses/${id}`, { method: 'DELETE' });\n        if (!response.ok) throw new Error('Failed to delete warehouse');\n        alert('‚úÖ Warehouse deleted successfully!');\n        await loadWarehouses();\n        loadWarehousesForCompany();\n        loadBinLocationsForCompany();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.deleteWarehouse = deleteWarehouse;\n\n// ========== BIN LOCATIONS ==========\nasync function loadBinLocations() {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-locations`);\n        binLocations = await response.json();\n        updateBinLocationDropdowns();\n    } catch (error) {\n        console.error('Error loading bin locations:', error);\n    }\n}\n\nasync function loadBinLocationsForCompany() {\n    if (!selectedCompanyId) return;\n    \n    try {\n        const warehouseFilter = document.getElementById('binLocationWarehouseFilter')?.value || '';\n        let url = `${CONFIG.apiUrl}/bin-locations`;\n        \n        // If warehouse filter is set, use it; otherwise get all bins for company's warehouses\n        if (warehouseFilter) {\n            url += `?warehouse_id=${warehouseFilter}`;\n        } else {\n            // Get all warehouses for this company first\n            const companyWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n            if (companyWarehouses.length > 0) {\n                // Fetch bins for all company warehouses\n                const allBins = [];\n                for (const wh of companyWarehouses) {\n                    const response = await fetch(`${CONFIG.apiUrl}/bin-locations?warehouse_id=${wh.id}`);\n                    const bins = await response.json();\n                    allBins.push(...bins);\n                }\n                binLocations = allBins;\n            } else {\n                binLocations = [];\n            }\n        }\n        \n        if (warehouseFilter) {\n            const response = await fetch(url);\n            binLocations = await response.json();\n        }\n        \n        updateBinLocationDropdowns();\n        \n        const listEl = document.getElementById('binLocationsList');\n        const noBinLocationsEl = document.getElementById('noBinLocations');\n        \n        if (listEl) {\n            if (binLocations.length === 0) {\n                listEl.innerHTML = '';\n                if (noBinLocationsEl) noBinLocationsEl.style.display = 'block';\n            } else {\n                if (noBinLocationsEl) noBinLocationsEl.style.display = 'none';\n                listEl.innerHTML = binLocations.map(b => `\n                    <div class=\"item-card\">\n                        <div class=\"item-header\">\n                            <h3>${escapeHtml(b.bin_code)}</h3>\n                            ${b.bin_name ? `<span class=\"item-id\">${escapeHtml(b.bin_name)}</span>` : ''}\n                        </div>\n                        <div class=\"item-details\">\n                            <div class=\"detail-item\"><strong>Warehouse:</strong> ${escapeHtml(b.warehouse_name || 'N/A')}</div>\n                            ${b.aisle ? `<div class=\"detail-item\"><strong>Aisle:</strong> ${escapeHtml(b.aisle)}</div>` : ''}\n                            ${b.shelf ? `<div class=\"detail-item\"><strong>Shelf:</strong> ${escapeHtml(b.shelf)}</div>` : ''}\n                            ${b.level ? `<div class=\"detail-item\"><strong>Level:</strong> ${escapeHtml(b.level)}</div>` : ''}\n                        </div>\n                        <div class=\"item-actions\">\n                            <button onclick=\"editBinLocation(${b.id})\" class=\"btn btn-small\">Edit</button>\n                            <button onclick=\"deleteBinLocation(${b.id})\" class=\"btn btn-small btn-danger\">Delete</button>\n                        </div>\n                    </div>\n                `).join('');\n            }\n        }\n    } catch (error) {\n        console.error('Error loading bin locations for company:', error);\n    }\n}\nwindow.loadBinLocationsForCompany = loadBinLocationsForCompany;\n\nfunction updateBinLocationDropdowns() {\n    const selects = document.querySelectorAll('select[id*=\"Bin\"], select[id*=\"bin\"]');\n    selects.forEach(select => {\n        // Skip filter dropdown\n        if (select.id === 'binLocationWarehouseFilter') return;\n        \n        const currentValue = select.value;\n        let filteredBins = binLocations;\n        \n        // If we have a selected company, filter bins by company's warehouses\n        if (selectedCompanyId) {\n            const companyWarehouseIds = warehouses.filter(w => w.company_id === selectedCompanyId).map(w => w.id);\n            filteredBins = binLocations.filter(b => companyWarehouseIds.includes(b.warehouse_id));\n        }\n        \n        select.innerHTML = '<option value=\"\">Select Bin Location</option>' + \n            filteredBins.map(b => `<option value=\"${b.id}\">${escapeHtml(b.bin_code)}${b.bin_name ? ' - ' + escapeHtml(b.bin_name) : ''}</option>`).join('');\n        if (currentValue) select.value = currentValue;\n    });\n}\n\nfunction openBinLocationModal(id = null) {\n    if (id) {\n        openEditBinLocationModal(id);\n    } else {\n        openAddBinLocationModal();\n    }\n}\nwindow.openBinLocationModal = openBinLocationModal;\n\nfunction openAddBinLocationModal() {\n    const warehouseSelect = document.getElementById('addBinLocationWarehouse');\n    \n    // Filter warehouses by selected company\n    let filteredWarehouses = warehouses;\n    if (selectedCompanyId) {\n        filteredWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n    }\n    \n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>' + \n        filteredWarehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n    \n    document.getElementById('addBinLocationCode').value = '';\n    document.getElementById('addBinLocationName').value = '';\n    document.getElementById('addBinLocationAisle').value = '';\n    document.getElementById('addBinLocationShelf').value = '';\n    document.getElementById('addBinLocationLevel').value = '';\n    document.getElementById('addBinLocationModal').style.display = 'flex';\n}\nwindow.openAddBinLocationModal = openAddBinLocationModal;\n\nfunction closeAddBinLocationModal() {\n    document.getElementById('addBinLocationModal').style.display = 'none';\n}\nwindow.closeAddBinLocationModal = closeAddBinLocationModal;\n\nfunction openEditBinLocationModal(id) {\n    const bin = binLocations.find(b => b.id === id);\n    if (!bin) return;\n    \n    const warehouseSelect = document.getElementById('editBinLocationWarehouse');\n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>' + \n        warehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n    \n    document.getElementById('editBinLocationId').value = id;\n    document.getElementById('editBinLocationCode').value = bin.bin_code;\n    document.getElementById('editBinLocationName').value = bin.bin_name || '';\n    document.getElementById('editBinLocationWarehouse').value = bin.warehouse_id;\n    document.getElementById('editBinLocationAisle').value = bin.aisle || '';\n    document.getElementById('editBinLocationShelf').value = bin.shelf || '';\n    document.getElementById('editBinLocationLevel').value = bin.level || '';\n    document.getElementById('editBinLocationModal').style.display = 'flex';\n}\nwindow.openEditBinLocationModal = openEditBinLocationModal;\n\nfunction closeEditBinLocationModal() {\n    document.getElementById('editBinLocationModal').style.display = 'none';\n}\nwindow.closeEditBinLocationModal = closeEditBinLocationModal;\n\nasync function handleAddBinLocation(event) {\n    event.preventDefault();\n    const formData = {\n        bin_code: document.getElementById('addBinLocationCode').value.trim(),\n        bin_name: document.getElementById('addBinLocationName').value.trim() || null,\n        warehouse_id: parseInt(document.getElementById('addBinLocationWarehouse').value),\n        aisle: document.getElementById('addBinLocationAisle').value.trim() || null,\n        shelf: document.getElementById('addBinLocationShelf').value.trim() || null,\n        level: document.getElementById('addBinLocationLevel').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-locations`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to save bin location');\n        \n        alert('‚úÖ Bin location created successfully!');\n        closeAddBinLocationModal();\n        await loadBinLocations();\n        loadBinLocationsForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleAddBinLocation = handleAddBinLocation;\n\nasync function handleEditBinLocation(event) {\n    event.preventDefault();\n    const id = document.getElementById('editBinLocationId').value;\n    const formData = {\n        bin_code: document.getElementById('editBinLocationCode').value.trim(),\n        bin_name: document.getElementById('editBinLocationName').value.trim() || null,\n        warehouse_id: parseInt(document.getElementById('editBinLocationWarehouse').value),\n        aisle: document.getElementById('editBinLocationAisle').value.trim() || null,\n        shelf: document.getElementById('editBinLocationShelf').value.trim() || null,\n        level: document.getElementById('editBinLocationLevel').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-locations/${id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to update bin location');\n        \n        alert('‚úÖ Bin location updated successfully!');\n        closeEditBinLocationModal();\n        await loadBinLocations();\n        loadBinLocationsForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleEditBinLocation = handleEditBinLocation;\n\nfunction editBinLocation(id) {\n    openBinLocationModal(id);\n}\nwindow.editBinLocation = editBinLocation;\n\nasync function deleteBinLocation(id) {\n    if (!confirm('Are you sure you want to delete this bin location?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-locations/${id}`, { method: 'DELETE' });\n        if (!response.ok) throw new Error('Failed to delete bin location');\n        alert('‚úÖ Bin location deleted successfully!');\n        await loadBinLocations();\n        loadBinLocationsForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.deleteBinLocation = deleteBinLocation;\n\n// ========== MANAGERS ==========\nasync function loadManagers() {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/managers`);\n        managers = await response.json();\n        updateManagerDropdowns();\n    } catch (error) {\n        console.error('Error loading managers:', error);\n    }\n}\n\nasync function loadManagersForCompany() {\n    if (!selectedCompanyId) return;\n    \n    try {\n        const warehouseFilter = document.getElementById('managerWarehouseFilter')?.value || '';\n        let url = `${CONFIG.apiUrl}/managers`;\n        \n        if (warehouseFilter) {\n            url += `?warehouse_id=${warehouseFilter}`;\n        } else {\n            // Get all managers for company's warehouses\n            const companyWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n            if (companyWarehouses.length > 0) {\n                const allManagers = [];\n                for (const wh of companyWarehouses) {\n                    const response = await fetch(`${CONFIG.apiUrl}/managers?warehouse_id=${wh.id}`);\n                    const mgrs = await response.json();\n                    allManagers.push(...mgrs);\n                }\n                managers = allManagers;\n            } else {\n                managers = [];\n            }\n        }\n        \n        if (warehouseFilter) {\n            const response = await fetch(url);\n            managers = await response.json();\n        }\n        \n        updateManagerDropdowns();\n        \n        const listEl = document.getElementById('managersList');\n        const noManagersEl = document.getElementById('noManagers');\n        \n        if (listEl) {\n            if (managers.length === 0) {\n                listEl.innerHTML = '';\n                if (noManagersEl) noManagersEl.style.display = 'block';\n            } else {\n                if (noManagersEl) noManagersEl.style.display = 'none';\n                listEl.innerHTML = managers.map(m => `\n                    <div class=\"item-card\">\n                        <div class=\"item-header\">\n                            <h3>${escapeHtml(m.manager_name)}</h3>\n                            <span class=\"item-id\">${escapeHtml(m.warehouse_name || 'N/A')}</span>\n                        </div>\n                        <div class=\"item-details\">\n                            <div class=\"detail-item\"><strong>Warehouse:</strong> ${escapeHtml(m.warehouse_name || 'N/A')}</div>\n                            ${m.email ? `<div class=\"detail-item\"><strong>Email:</strong> ${escapeHtml(m.email)}</div>` : ''}\n                            ${m.phone ? `<div class=\"detail-item\"><strong>Phone:</strong> ${escapeHtml(m.phone)}</div>` : ''}\n                        </div>\n                        <div class=\"item-actions\">\n                            <button onclick=\"editManager(${m.id})\" class=\"btn btn-small\">Edit</button>\n                            <button onclick=\"deleteManager(${m.id})\" class=\"btn btn-small btn-danger\">Delete</button>\n                        </div>\n                    </div>\n                `).join('');\n            }\n        }\n    } catch (error) {\n        console.error('Error loading managers for company:', error);\n    }\n}\nwindow.loadManagersForCompany = loadManagersForCompany;\n\nfunction updateManagerDropdowns() {\n    const selects = document.querySelectorAll('select[id*=\"Manager\"], select[id*=\"manager\"]');\n    selects.forEach(select => {\n        // Skip filter dropdown\n        if (select.id === 'managerWarehouseFilter') return;\n        \n        const currentValue = select.value;\n        let filteredManagers = managers;\n        \n        // If we have a selected company, filter managers by company's warehouses\n        if (selectedCompanyId) {\n            const companyWarehouseIds = warehouses.filter(w => w.company_id === selectedCompanyId).map(w => w.id);\n            filteredManagers = managers.filter(m => companyWarehouseIds.includes(m.warehouse_id));\n        }\n        \n        select.innerHTML = '<option value=\"\">Select Manager</option>' + \n            filteredManagers.map(m => `<option value=\"${m.id}\">${escapeHtml(m.manager_name)} - ${escapeHtml(m.warehouse_name || 'N/A')}</option>`).join('');\n        if (currentValue) select.value = currentValue;\n    });\n}\n\nfunction openManagerModal(id = null) {\n    if (id) {\n        openEditManagerModal(id);\n    } else {\n        openAddManagerModal();\n    }\n}\nwindow.openManagerModal = openManagerModal;\n\nfunction openAddManagerModal() {\n    const warehouseSelect = document.getElementById('addManagerWarehouse');\n    \n    // Filter warehouses by selected company\n    let filteredWarehouses = warehouses;\n    if (selectedCompanyId) {\n        filteredWarehouses = warehouses.filter(w => w.company_id === selectedCompanyId);\n    }\n    \n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>' + \n        filteredWarehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n    \n    document.getElementById('addManagerName').value = '';\n    document.getElementById('addManagerEmail').value = '';\n    document.getElementById('addManagerPhone').value = '';\n    document.getElementById('addManagerModal').style.display = 'flex';\n}\nwindow.openAddManagerModal = openAddManagerModal;\n\nfunction closeAddManagerModal() {\n    document.getElementById('addManagerModal').style.display = 'none';\n}\nwindow.closeAddManagerModal = closeAddManagerModal;\n\nfunction openEditManagerModal(id) {\n    const manager = managers.find(m => m.id === id);\n    if (!manager) return;\n    \n    const warehouseSelect = document.getElementById('editManagerWarehouse');\n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>' + \n        warehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n    \n    document.getElementById('editManagerId').value = id;\n    document.getElementById('editManagerName').value = manager.manager_name;\n    document.getElementById('editManagerWarehouse').value = manager.warehouse_id;\n    document.getElementById('editManagerEmail').value = manager.email || '';\n    document.getElementById('editManagerPhone').value = manager.phone || '';\n    document.getElementById('editManagerModal').style.display = 'flex';\n}\nwindow.openEditManagerModal = openEditManagerModal;\n\nfunction closeEditManagerModal() {\n    document.getElementById('editManagerModal').style.display = 'none';\n}\nwindow.closeEditManagerModal = closeEditManagerModal;\n\nasync function handleAddManager(event) {\n    event.preventDefault();\n    const formData = {\n        manager_name: document.getElementById('addManagerName').value.trim(),\n        warehouse_id: parseInt(document.getElementById('addManagerWarehouse').value),\n        email: document.getElementById('addManagerEmail').value.trim() || null,\n        phone: document.getElementById('addManagerPhone').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/managers`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to save manager');\n        \n        alert('‚úÖ Manager created successfully!');\n        closeAddManagerModal();\n        await loadManagers();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleAddManager = handleAddManager;\n\nasync function handleEditManager(event) {\n    event.preventDefault();\n    const id = document.getElementById('editManagerId').value;\n    const formData = {\n        manager_name: document.getElementById('editManagerName').value.trim(),\n        warehouse_id: parseInt(document.getElementById('editManagerWarehouse').value),\n        email: document.getElementById('editManagerEmail').value.trim() || null,\n        phone: document.getElementById('editManagerPhone').value.trim() || null,\n    };\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/managers/${id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to update manager');\n        \n        alert('‚úÖ Manager updated successfully!');\n        closeEditManagerModal();\n        await loadManagers();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleEditManager = handleEditManager;\n\nfunction editManager(id) {\n    openManagerModal(id);\n}\nwindow.editManager = editManager;\n\nasync function deleteManager(id) {\n    if (!confirm('Are you sure you want to deactivate this manager?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/managers/${id}`, { method: 'DELETE' });\n        if (!response.ok) throw new Error('Failed to deactivate manager');\n        alert('‚úÖ Manager deactivated successfully!');\n        await loadManagers();\n        loadManagersForCompany();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.deleteManager = deleteManager;\n\n// ========== STOCK TAKE ==========\nfunction updateWarehousesForStock() {\n    const companyId = document.getElementById('stockCompany').value;\n    const warehouseSelect = document.getElementById('stockWarehouse');\n    \n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>';\n    if (companyId) {\n        const companyWarehouses = warehouses.filter(w => w.company_id == companyId);\n        companyWarehouses.forEach(w => {\n            warehouseSelect.innerHTML += `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`;\n        });\n    }\n    \n    // Clear dependent fields\n    document.getElementById('stockWarehouse').value = '';\n    updateManagersAndBins();\n}\nwindow.updateWarehousesForStock = updateWarehousesForStock;\n\nfunction updateManagersAndBins() {\n    const warehouseId = document.getElementById('stockWarehouse').value;\n    const managerSelect = document.getElementById('stockManager');\n    const binSelect = document.getElementById('stockBinLocation');\n    \n    // Update managers (only for selected warehouse)\n    managerSelect.innerHTML = '<option value=\"\">Select Manager</option>';\n    if (warehouseId) {\n        const warehouseManagers = managers.filter(m => m.warehouse_id == warehouseId);\n        warehouseManagers.forEach(m => {\n            managerSelect.innerHTML += `<option value=\"${m.id}\">${escapeHtml(m.manager_name)}</option>`;\n        });\n    }\n    \n    // Update bin locations (only for selected warehouse)\n    binSelect.innerHTML = '<option value=\"\">Select Bin Location</option>';\n    if (warehouseId) {\n        const warehouseBins = binLocations.filter(b => b.warehouse_id == warehouseId);\n        warehouseBins.forEach(b => {\n            binSelect.innerHTML += `<option value=\"${b.id}\">${escapeHtml(b.bin_code)}${b.bin_name ? ' - ' + escapeHtml(b.bin_name) : ''}</option>`;\n        });\n    }\n}\nwindow.updateManagersAndBins = updateManagersAndBins;\n\nasync function handleStockTake(event) {\n    event.preventDefault();\n    \n    const btn = document.getElementById('stockTakeBtn');\n    const text = document.getElementById('stockTakeText');\n    const spinner = document.getElementById('stockTakeSpinner');\n    const result = document.getElementById('stockTakeResult');\n    \n    const formData = {\n        item_name: document.getElementById('stockItemName').value.trim(),\n        item_code: document.getElementById('stockItemCode').value.trim() || null,\n        quantity: parseInt(document.getElementById('stockQuantity').value) || 0,\n        company_id: parseInt(document.getElementById('stockCompany').value),\n        warehouse_id: parseInt(document.getElementById('stockWarehouse').value),\n        counted_by_manager_id: parseInt(document.getElementById('stockManager').value),\n        bin_location_id: document.getElementById('stockBinLocation').value ? parseInt(document.getElementById('stockBinLocation').value) : null,\n        date: document.getElementById('stockDate').value || null,\n        notes: document.getElementById('stockNotes').value.trim() || null,\n    };\n    \n    btn.disabled = true;\n    text.style.display = 'none';\n    spinner.style.display = 'inline';\n    result.style.display = 'none';\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/items`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to add item');\n        }\n        \n        result.style.display = 'block';\n        result.className = 'result-message success';\n        result.textContent = `‚úÖ Successfully added item \"${formData.item_name}\"!`;\n        \n        document.getElementById('stockTakeForm').reset();\n        document.getElementById('stockDate').value = new Date().toISOString().split('T')[0];\n        \n    } catch (error) {\n        result.style.display = 'block';\n        result.className = 'result-message error';\n        result.textContent = `‚ùå Error: ${error.message}`;\n    } finally {\n        btn.disabled = false;\n        text.style.display = 'inline';\n        spinner.style.display = 'none';\n    }\n}\nwindow.handleStockTake = handleStockTake;\n\n// ========== VIEW ITEMS ==========\nasync function loadItems() {\n    const loadingEl = document.getElementById('loadingStock');\n    const errorEl = document.getElementById('errorStock');\n    const itemsListEl = document.getElementById('stockItemsList');\n    const noItemsEl = document.getElementById('noStockItems');\n    \n    if (loadingEl) loadingEl.style.display = 'block';\n    if (errorEl) errorEl.style.display = 'none';\n    if (itemsListEl) itemsListEl.innerHTML = '';\n    \n    try {\n        const searchTerm = document.getElementById('searchStockInput')?.value || '';\n        \n        let url = `${CONFIG.apiUrl}/items`;\n        if (searchTerm) {\n            url += `?search=${encodeURIComponent(searchTerm)}`;\n        }\n        \n        const response = await fetch(url);\n        if (!response.ok) throw new Error(`Server error: ${response.status}`);\n        \n        allItems = await response.json();\n        filteredItems = [...allItems];\n        \n        displayItems(filteredItems);\n        \n    } catch (error) {\n        console.error('Error loading items:', error);\n        if (errorEl) {\n            errorEl.style.display = 'block';\n            errorEl.textContent = `Error loading items: ${error.message}`;\n        }\n    } finally {\n        if (loadingEl) loadingEl.style.display = 'none';\n    }\n}\nwindow.loadItems = loadItems;\n\nfunction updateViewFilters() {\n    // Update warehouse filter\n    const warehouseFilter = document.getElementById('viewWarehouseFilter');\n    if (warehouseFilter) {\n        const currentValue = warehouseFilter.value;\n        warehouseFilter.innerHTML = '<option value=\"\">All Warehouses</option>' + \n            warehouses.map(w => `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`).join('');\n        if (currentValue) warehouseFilter.value = currentValue;\n    }\n    \n    // Update manager filter\n    const managerFilter = document.getElementById('viewManagerFilter');\n    if (managerFilter) {\n        const currentValue = managerFilter.value;\n        managerFilter.innerHTML = '<option value=\"\">All Managers</option>' + \n            managers.map(m => `<option value=\"${m.id}\">${escapeHtml(m.manager_name)}</option>`).join('');\n        if (currentValue) managerFilter.value = currentValue;\n    }\n}\n\nfunction displayItems(items) {\n    const itemsListEl = document.getElementById('stockItemsList');\n    const noItemsEl = document.getElementById('noStockItems');\n    \n    if (!itemsListEl) return;\n    \n    if (items.length === 0) {\n        itemsListEl.innerHTML = '';\n        if (noItemsEl) noItemsEl.style.display = 'block';\n        return;\n    }\n    \n    if (noItemsEl) noItemsEl.style.display = 'none';\n    \n    itemsListEl.innerHTML = items.map(item => `\n        <div class=\"item-card\">\n            <div class=\"item-header\">\n                <h3>${escapeHtml(item.item_name || 'Unnamed Item')}</h3>\n                <span class=\"item-id\">ID: ${item.id}</span>\n            </div>\n            <div class=\"item-details\">\n                <div class=\"detail-item\">\n                    <strong>Quantity:</strong> <span class=\"quantity-badge\">${item.quantity || 0}</span>\n                </div>\n                ${item.item_code ? `<div class=\"detail-item\"><strong>Item Code:</strong> ${escapeHtml(item.item_code)}</div>` : ''}\n                <div class=\"detail-item\"><strong>Company:</strong> ${escapeHtml(item.company_name || 'N/A')}</div>\n                <div class=\"detail-item\"><strong>Warehouse:</strong> ${escapeHtml(item.warehouse_name || 'N/A')}</div>\n                ${item.bin_location_code ? `<div class=\"detail-item\"><strong>Bin Location:</strong> ${escapeHtml(item.bin_location_code)}</div>` : ''}\n                ${item.counted_by ? `<div class=\"detail-item\"><strong>Counted By:</strong> ${escapeHtml(item.counted_by)}</div>` : ''}\n                ${item.date ? `<div class=\"detail-item\"><strong>Date:</strong> ${escapeHtml(item.date)}</div>` : ''}\n                ${item.notes ? `<div class=\"detail-item\"><strong>Notes:</strong> ${escapeHtml(item.notes)}</div>` : ''}\n                ${item.created_at ? `<div class=\"detail-item\"><strong>Added:</strong> ${formatDate(item.created_at)}</div>` : ''}\n            </div>\n        </div>\n    `).join('');\n}\n\nfunction handleStockSearch() {\n    loadItems(); // Reload with search term\n}\nwindow.handleStockSearch = handleStockSearch;\n\nfunction openEditItemModal(itemId) {\n    const item = allItems.find(i => i.id === itemId);\n    if (!item) return;\n    \n    document.getElementById('editItemId').value = item.id;\n    document.getElementById('editItemName').value = item.item_name || '';\n    document.getElementById('editItemCode').value = item.item_code || '';\n    document.getElementById('editQuantity').value = item.quantity || 0;\n    \n    document.getElementById('editItemModal').style.display = 'flex';\n}\nwindow.openEditItemModal = openEditItemModal;\n\nfunction closeEditItemModal() {\n    document.getElementById('editItemModal').style.display = 'none';\n}\nwindow.closeEditItemModal = closeEditItemModal;\n\nasync function handleUpdateItem(event) {\n    event.preventDefault();\n    \n    const itemId = document.getElementById('editItemId').value;\n    const formData = {\n        item_name: document.getElementById('editItemName').value.trim(),\n        item_code: document.getElementById('editItemCode').value.trim() || null,\n        quantity: parseInt(document.getElementById('editQuantity').value) || 0,\n    };\n    \n    // Get existing item to preserve other fields\n    const existing = allItems.find(i => i.id == itemId);\n    if (existing) {\n        formData.company_id = existing.company_id;\n        formData.warehouse_id = existing.warehouse_id;\n        formData.bin_location_id = existing.bin_location_id;\n        formData.counted_by_manager_id = existing.counted_by_manager_id;\n        formData.date = existing.date;\n        formData.notes = existing.notes;\n    }\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/items/${itemId}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(formData)\n        });\n        \n        if (!response.ok) throw new Error('Failed to update item');\n        \n        alert('‚úÖ Item updated successfully!');\n        closeEditItemModal();\n        loadItems();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nconst editItemForm = document.getElementById('editItemForm');\nif (editItemForm) {\n    editItemForm.onsubmit = handleUpdateItem;\n}\n\nasync function deleteItem(itemId) {\n    if (!confirm('Are you sure you want to delete this item?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/items/${itemId}`, { method: 'DELETE' });\n        if (!response.ok) throw new Error('Failed to delete item');\n        alert('‚úÖ Item deleted successfully!');\n        loadItems();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.deleteItem = deleteItem;\n\n// ========== NEW STOCK TAKE WORKFLOW ==========\n// Note: currentStockTake, currentBinLocation, and currentBinItems are already declared at the top of the file\n\nasync function checkActiveStockTake() {\n    // This will be called when stock take tab is opened\n    // Ensure variables are initialized\n    if (typeof currentStockTake === 'undefined') {\n        currentStockTake = null;\n    }\n    // Status will be updated by updateStockTakeStatus() when tab is shown\n}\n\nfunction updateWarehousesForOpenStockTake() {\n    const companyId = document.getElementById('openStockTakeCompany').value;\n    const warehouseSelect = document.getElementById('openStockTakeWarehouse');\n    \n    warehouseSelect.innerHTML = '<option value=\"\">Select Warehouse</option>';\n    if (companyId) {\n        const companyWarehouses = warehouses.filter(w => w.company_id == companyId);\n        companyWarehouses.forEach(w => {\n            warehouseSelect.innerHTML += `<option value=\"${w.id}\">${escapeHtml(w.warehouse_name)}</option>`;\n        });\n    }\n    \n    // Clear validation message\n    const validationMsg = document.getElementById('managerValidationMessage');\n    if (validationMsg) {\n        validationMsg.style.display = 'none';\n    }\n}\nwindow.updateWarehousesForOpenStockTake = updateWarehousesForOpenStockTake;\n\nfunction validateManagerForWarehouse() {\n    const warehouseId = document.getElementById('openStockTakeWarehouse').value;\n    const validationMsg = document.getElementById('managerValidationMessage');\n    \n    if (!validationMsg) return;\n    \n    if (!warehouseId) {\n        validationMsg.style.display = 'none';\n        return;\n    }\n    \n    // Check if there are any managers for this warehouse\n    const warehouseManagers = managers.filter(m => m.warehouse_id == warehouseId && m.is_active !== 0);\n    \n    if (warehouseManagers.length === 0) {\n        validationMsg.style.display = 'block';\n        validationMsg.className = 'validation-message error';\n        validationMsg.innerHTML = '‚ö†Ô∏è No active managers found for this warehouse. Please add a manager in Setup before opening a stock take.';\n    } else {\n        validationMsg.style.display = 'block';\n        validationMsg.className = 'validation-message success';\n        validationMsg.innerHTML = `‚úÖ ${warehouseManagers.length} manager(s) available for this warehouse: ${warehouseManagers.map(m => escapeHtml(m.manager_name)).join(', ')}`;\n    }\n}\nwindow.validateManagerForWarehouse = validateManagerForWarehouse;\n\nasync function openStockTake() {\n    const companyId = document.getElementById('openStockTakeCompany').value;\n    const warehouseId = document.getElementById('openStockTakeWarehouse').value;\n    \n    if (!companyId || !warehouseId) {\n        alert('Please select Company and Warehouse');\n        return;\n    }\n    \n    // Validate that at least one manager exists for this warehouse\n    const warehouseManagers = managers.filter(m => m.warehouse_id == warehouseId && m.is_active !== 0);\n    \n    if (warehouseManagers.length === 0) {\n        alert('‚ùå Cannot open stock take: No active managers found for this warehouse.\\n\\nPlease add a manager in Setup before opening a stock take.');\n        return;\n    }\n    \n    // Use the first active manager (or you could let the user choose later)\n    const managerId = warehouseManagers[0].id;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                company_id: parseInt(companyId),\n                warehouse_id: parseInt(warehouseId),\n                opened_by_manager_id: managerId\n            })\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to open stock take');\n        }\n        \n        const data = await response.json();\n        currentStockTake = data.stockTake;\n        \n        updateStockTakeStatus();\n        \n        // Notify user and refresh open stock takes list if visible\n        alert(`‚úÖ Stock take opened successfully!\\n\\nManager: ${warehouseManagers[0].manager_name}\\n\\nStock Take ID: ${currentStockTake.id}`);\n        \n        // If on open stock takes tab, refresh the list\n        if (document.getElementById('openStockTakesTab')?.classList.contains('active')) {\n            loadOpenStockTakes();\n        }\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.openStockTake = openStockTake;\n\nasync function closeStockTake() {\n    if (!currentStockTake || !confirm('Are you sure you want to close this stock take?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes/${currentStockTake.id}/close`, {\n            method: 'PUT'\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to close stock take');\n        }\n        \n        currentStockTake = null;\n        currentBinLocation = null;\n        currentBinItems = [];\n        \n        updateStockTakeStatus();\n        clearBinLocation();\n        alert('‚úÖ Stock take closed successfully!');\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.closeStockTake = closeStockTake;\n\nfunction updateStockTakeStatus() {\n    // Ensure currentStockTake is defined (should always be, but check for safety)\n    if (typeof currentStockTake === 'undefined') {\n        currentStockTake = null;\n    }\n    \n    const statusBox = document.getElementById('stockTakeStatus');\n    const openBtn = document.getElementById('openStockTakeBtn');\n    const closeBtn = document.getElementById('closeStockTakeBtn');\n    const binSection = document.getElementById('binLocationSection');\n    const itemSection = document.getElementById('itemScanSection');\n    const binItemsSection = document.getElementById('binItemsSection');\n    \n    // Only update manager section if it exists (manager mode)\n    if (statusBox && openBtn && closeBtn) {\n        if (currentStockTake) {\n            statusBox.innerHTML = `\n                <p><strong>‚úÖ Stock Take Open</strong></p>\n                <p>Company: ${escapeHtml(currentStockTake.company_name)}</p>\n                <p>Warehouse: ${escapeHtml(currentStockTake.warehouse_name)}</p>\n                <p>Opened: ${formatDate(currentStockTake.opened_at)}</p>\n            `;\n            statusBox.className = 'status-box success';\n            openBtn.style.display = 'none';\n            closeBtn.style.display = 'inline-block';\n        } else {\n            statusBox.innerHTML = '<p>No stock take open</p>';\n            statusBox.className = 'status-box';\n            openBtn.style.display = 'inline-block';\n            closeBtn.style.display = 'none';\n        }\n    }\n    \n    // Handle scanning sections visibility\n    if (currentStockTake) {\n        // Show scanning sections - ALWAYS show bin location section when stock take is open\n        if (binSection) {\n            binSection.style.display = 'block';\n            binSection.style.visibility = 'visible';\n        }\n        \n        // Scroll to bin location section to make it visible (manager mode)\n        if (currentRole === 'manager') {\n            setTimeout(() => {\n                if (binSection) {\n                    binSection.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }\n                // Focus on bin location input for immediate scanning\n                const binInput = document.getElementById('binLocationInput');\n                if (binInput) {\n                    binInput.focus();\n                    binInput.select();\n                }\n            }, 100);\n        }\n    } else {\n        // Hide scanning sections when no stock take\n        if (binSection) binSection.style.display = 'none';\n        if (itemSection) itemSection.style.display = 'none';\n        if (binItemsSection) binItemsSection.style.display = 'none';\n    }\n}\n\n// Counter mode: Scan bin location to start counting (requires open stock take)\nasync function handleCounterBinLocationScan() {\n    const binCode = document.getElementById('counterBinLocationInput').value.trim();\n    \n    if (!binCode) {\n        alert('Please enter or scan a bin location code');\n        return;\n    }\n    \n    try {\n        // First, lookup the bin location to get company/warehouse\n        const lookupResponse = await fetch(`${CONFIG.apiUrl}/bin-locations/lookup?bin_code=${encodeURIComponent(binCode)}`);\n        \n        if (!lookupResponse.ok) {\n            const error = await lookupResponse.json();\n            throw new Error(error.error || 'Bin location not found');\n        }\n        \n        const binLocation = await lookupResponse.json();\n        \n        console.log('Bin location found:', binLocation);\n        console.log('Bin location company_id:', binLocation.company_id, 'type:', typeof binLocation.company_id);\n        console.log('Bin location warehouse_id:', binLocation.warehouse_id, 'type:', typeof binLocation.warehouse_id);\n        \n        // Check if there's an open stock take for this warehouse/company\n        // Stock takes are opened at Company + Warehouse level, not bin location level\n        let stockTake = null;\n        try {\n        // Ensure we're using the correct IDs from the bin location\n        // Convert to integers to ensure proper comparison\n        const companyId = parseInt(binLocation.company_id);\n        const warehouseId = parseInt(binLocation.warehouse_id);\n        \n        console.log('Bin location data:', binLocation);\n        console.log('Checking for open stock take with company_id:', companyId, '(type:', typeof companyId, ')', 'warehouse_id:', warehouseId, '(type:', typeof warehouseId, ')');\n            \n            const stockTakeResponse = await fetch(`${CONFIG.apiUrl}/stock-takes/active?company_id=${companyId}&warehouse_id=${warehouseId}`);\n            \n            console.log('Stock take response status:', stockTakeResponse.status);\n            \n            if (stockTakeResponse.ok) {\n                const responseData = await stockTakeResponse.json();\n                console.log('Stock take response:', responseData);\n                \n                // Check if response has debug info (when no stock take found)\n                if (responseData.debug) {\n                    console.log('Debug info from server:', responseData.debug);\n                    stockTake = null;\n                    console.log('No matching stock take found. All open stock takes:', responseData.debug.all_open_stock_takes);\n                } else if (responseData.result === null) {\n                    stockTake = null;\n                    console.log('No stock take found (explicit null result)');\n                } else if (!responseData || responseData === null || (typeof responseData === 'object' && Object.keys(responseData).length === 0)) {\n                    stockTake = null;\n                    console.log('No stock take found (null or empty response)');\n                } else {\n                    // Use result if available, otherwise use responseData directly\n                    stockTake = responseData.result || responseData;\n                    console.log('Found stock take:', stockTake);\n                    console.log('Stock take company_id:', stockTake.company_id, 'type:', typeof stockTake.company_id);\n                    console.log('Stock take warehouse_id:', stockTake.warehouse_id, 'type:', typeof stockTake.warehouse_id);\n                }\n            } else if (stockTakeResponse.status === 404) {\n                // 404 means no stock take found - this is expected, not an error\n                stockTake = null;\n                console.log('No stock take found (404 response)');\n            } else {\n                // Other HTTP error - try to get error message\n                let errorMessage = 'Failed to check for open stock take';\n                try {\n                    const errorData = await stockTakeResponse.json();\n                    errorMessage = errorData.error || errorMessage;\n                    console.error('Error response:', errorData);\n                } catch (e) {\n                    errorMessage = `Server error (${stockTakeResponse.status}): ${stockTakeResponse.statusText}`;\n                }\n                throw new Error(errorMessage);\n            }\n        } catch (error) {\n            // If it's already our custom error, re-throw it\n            if (error.message.includes('Failed to check') || error.message.includes('Server error')) {\n                throw error;\n            }\n            // Network or other errors - show helpful message\n            console.error('Error checking for open stock take:', error);\n            throw new Error('Unable to connect to server. Please check your internet connection and try again.');\n        }\n        \n        // Counter can ONLY count against existing open stock takes\n        if (!stockTake) {\n            // Get debug info if available\n            let debugInfo = '';\n            try {\n                const debugResponse = await fetch(`${CONFIG.apiUrl}/stock-takes/active?company_id=${companyId}&warehouse_id=${warehouseId}`);\n                if (debugResponse.ok) {\n                    const debugData = await debugResponse.json();\n                    if (debugData.debug && debugData.debug.all_open_stock_takes) {\n                        debugInfo = `\\n\\nDebug: Found ${debugData.debug.all_open_stock_takes.length} open stock take(s) in database:\\n`;\n                        debugData.debug.all_open_stock_takes.forEach((st, idx) => {\n                            debugInfo += `${idx + 1}. ID: ${st.id}, Company ID: ${st.company_id}, Warehouse ID: ${st.warehouse_id}, Company: ${st.company_name || 'N/A'}, Warehouse: ${st.warehouse_name || 'N/A'}\\n`;\n                        });\n                        debugInfo += `\\nRequested: Company ID: ${companyId}, Warehouse ID: ${warehouseId}`;\n                    }\n                }\n            } catch (e) {\n                console.error('Error getting debug info:', e);\n            }\n            \n            throw new Error(`No open stock take found for this bin location.\\n\\nBin: ${binLocation.bin_code}\\nWarehouse: ${binLocation.warehouse_name} (ID: ${warehouseId})\\nCompany: ${binLocation.company_name} (ID: ${companyId})\\n\\nPlease ask a manager to open a stock take for this Company and Warehouse combination first.${debugInfo}`);\n        }\n        \n        // Verify bin location belongs to the stock take's warehouse/company\n        // Use loose comparison to handle string/number mismatches\n        const binCompanyId = parseInt(binLocation.company_id);\n        const binWarehouseId = parseInt(binLocation.warehouse_id);\n        const stockTakeCompanyId = parseInt(stockTake.company_id);\n        const stockTakeWarehouseId = parseInt(stockTake.warehouse_id);\n        \n        console.log('Comparing IDs - Bin:', binCompanyId, binWarehouseId, 'Stock Take:', stockTakeCompanyId, stockTakeWarehouseId);\n        \n        if (binCompanyId !== stockTakeCompanyId || binWarehouseId !== stockTakeWarehouseId) {\n            throw new Error(`Bin location does not match the open stock take.\\n\\nBin: ${binLocation.bin_code}\\nBin Company ID: ${binCompanyId}, Warehouse ID: ${binWarehouseId}\\nStock Take Company ID: ${stockTakeCompanyId}, Warehouse ID: ${stockTakeWarehouseId}\\n\\nPlease scan a bin from the correct warehouse.`);\n        }\n        \n        // Set current stock take and bin location\n        currentStockTake = stockTake;\n        currentBinLocation = binLocation;\n        \n        // Update UI\n        updateStockTakeStatus();\n        \n        // Show bin location info\n        document.getElementById('currentBinCode').textContent = binLocation.bin_code;\n        document.getElementById('currentBinInfo').textContent = `${binLocation.warehouse_name} - ${binLocation.company_name}`;\n        document.getElementById('currentBinLocation').style.display = 'block';\n        document.getElementById('clearBinBtn').style.display = 'inline-block';\n        \n        // Hide counter start section, show scanning sections\n        document.getElementById('counterStartSection').style.display = 'none';\n        document.getElementById('binLocationSection').style.display = 'block';\n        \n        // Show item scan section and bin items section\n        const itemSection = document.getElementById('itemScanSection');\n        const binItemsSection = document.getElementById('binItemsSection');\n        if (itemSection) itemSection.style.display = 'block';\n        if (binItemsSection) binItemsSection.style.display = 'block';\n        \n        // Scroll to item scan section\n        setTimeout(() => {\n            if (itemSection) {\n                itemSection.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                // Focus on item code input\n                const itemCodeInput = document.getElementById('itemCodeInput');\n                if (itemCodeInput) itemCodeInput.focus();\n            }\n        }, 300);\n        \n        // Load items for this bin\n        loadBinItems();\n        \n        // Clear counter bin location input\n        document.getElementById('counterBinLocationInput').value = '';\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n        // Keep focus on input for retry\n        setTimeout(() => {\n            const counterBinInput = document.getElementById('counterBinLocationInput');\n            if (counterBinInput) counterBinInput.focus();\n        }, 100);\n    }\n}\nwindow.handleCounterBinLocationScan = handleCounterBinLocationScan;\n\n// Manager mode: Scan bin location (requires stock take to be open first)\nasync function handleBinLocationScan() {\n    const binCode = document.getElementById('binLocationInput').value.trim();\n    \n    if (!binCode) {\n        alert('Please enter or scan a bin location code');\n        return;\n    }\n    \n    if (!currentStockTake) {\n        alert('Please open a stock take first');\n        return;\n    }\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-locations/lookup?bin_code=${encodeURIComponent(binCode)}&stock_take_id=${currentStockTake.id}`);\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Bin location not found or invalid');\n        }\n        \n        const binLocation = await response.json();\n        currentBinLocation = binLocation;\n        \n        // Show bin location info\n        document.getElementById('currentBinCode').textContent = binLocation.bin_code;\n        document.getElementById('currentBinInfo').textContent = `${binLocation.warehouse_name} - ${binLocation.company_name}`;\n        document.getElementById('currentBinLocation').style.display = 'block';\n        document.getElementById('clearBinBtn').style.display = 'inline-block';\n        \n        // Show item scan section and bin items section\n        const itemSection = document.getElementById('itemScanSection');\n        const binItemsSection = document.getElementById('binItemsSection');\n        if (itemSection) itemSection.style.display = 'block';\n        if (binItemsSection) binItemsSection.style.display = 'block';\n        \n        // Scroll to item scan section\n        setTimeout(() => {\n            if (itemSection) {\n                itemSection.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                // Focus on item code input\n                const itemCodeInput = document.getElementById('itemCodeInput');\n                if (itemCodeInput) itemCodeInput.focus();\n            }\n        }, 300);\n        \n        // Load items for this bin\n        loadBinItems();\n        \n        // Clear bin location input\n        document.getElementById('binLocationInput').value = '';\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.handleBinLocationScan = handleBinLocationScan;\n\nfunction clearBinLocation() {\n    if (confirm('Clear current bin location? All unsaved items will be lost.')) {\n        currentBinLocation = null;\n        currentBinItems = [];\n        \n        document.getElementById('currentBinLocation').style.display = 'none';\n        document.getElementById('clearBinBtn').style.display = 'none';\n        document.getElementById('itemScanSection').style.display = 'none';\n        document.getElementById('binItemsSection').style.display = 'none';\n        document.getElementById('binItemsList').innerHTML = '';\n        document.getElementById('itemCodeInput').value = '';\n        document.getElementById('itemNameInput').value = '';\n        document.getElementById('itemQuantityInput').value = '0';\n    }\n}\nwindow.clearBinLocation = clearBinLocation;\n\nasync function handleItemCodeScan() {\n    const itemCode = document.getElementById('itemCodeInput').value.trim();\n    \n    if (!itemCode) {\n        alert('Please enter or scan an item code');\n        return;\n    }\n    \n    // Auto-focus on quantity input\n    document.getElementById('itemQuantityInput').focus();\n    document.getElementById('itemQuantityInput').select();\n}\nwindow.handleItemCodeScan = handleItemCodeScan;\n\n// Allow Enter key on item code to move to quantity\ndocument.getElementById('itemCodeInput')?.addEventListener('keypress', function(e) {\n    if (e.key === 'Enter') {\n        e.preventDefault();\n        handleItemCodeScan();\n    }\n});\n\nasync function addItemToBin() {\n    if (!currentStockTake || !currentBinLocation) {\n        alert('Please scan a bin location first');\n        return;\n    }\n    \n    const itemCode = document.getElementById('itemCodeInput').value.trim();\n    const itemName = document.getElementById('itemNameInput').value.trim();\n    const quantity = parseInt(document.getElementById('itemQuantityInput').value) || 0;\n    \n    if (!itemCode) {\n        alert('Please enter or scan an item code');\n        return;\n    }\n    \n    if (quantity < 0) {\n        alert('Quantity must be 0 or greater');\n        return;\n    }\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-location-counts`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                stock_take_id: currentStockTake.id,\n                bin_location_id: currentBinLocation.id,\n                item_code: itemCode,\n                item_name: itemName || null,\n                quantity: quantity,\n                counted_by_manager_id: currentStockTake.opened_by_manager_id\n            })\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to add item');\n        }\n        \n        // Clear inputs\n        document.getElementById('itemCodeInput').value = '';\n        document.getElementById('itemNameInput').value = '';\n        document.getElementById('itemQuantityInput').value = '0';\n        \n        // Focus back on item code for next scan\n        document.getElementById('itemCodeInput').focus();\n        \n        // Reload bin items\n        loadBinItems();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.addItemToBin = addItemToBin;\n\nasync function loadBinItems() {\n    if (!currentStockTake || !currentBinLocation) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-location-counts?stock_take_id=${currentStockTake.id}&bin_location_id=${currentBinLocation.id}&submitted=0`);\n        \n        if (!response.ok) throw new Error('Failed to load bin items');\n        \n        currentBinItems = await response.json();\n        \n        const listEl = document.getElementById('binItemsList');\n        const noItemsEl = document.getElementById('noBinItems');\n        \n        if (currentBinItems.length === 0) {\n            listEl.innerHTML = '';\n            noItemsEl.style.display = 'block';\n        } else {\n            noItemsEl.style.display = 'none';\n            listEl.innerHTML = currentBinItems.map(item => `\n                <div class=\"item-card\">\n                    <div class=\"item-header\">\n                        <h3>${escapeHtml(item.item_code)}</h3>\n                        <span class=\"quantity-badge\">Qty: ${item.quantity}</span>\n                    </div>\n                    ${item.item_name ? `<div class=\"item-details\"><div class=\"detail-item\"><strong>Name:</strong> ${escapeHtml(item.item_name)}</div></div>` : ''}\n                    <div class=\"item-actions\">\n                        <button onclick=\"removeBinItem(${item.id})\" class=\"btn btn-small btn-danger\">Remove</button>\n                    </div>\n                </div>\n            `).join('');\n        }\n    } catch (error) {\n        console.error('Error loading bin items:', error);\n    }\n}\nwindow.loadBinItems = loadBinItems;\n\nasync function removeBinItem(itemId) {\n    if (!confirm('Remove this item from the bin?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-location-counts/${itemId}`, {\n            method: 'DELETE'\n        });\n        \n        if (!response.ok) throw new Error('Failed to remove item');\n        \n        loadBinItems();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.removeBinItem = removeBinItem;\n\nfunction clearBinItems() {\n    if (!confirm('Clear all items from current bin? This cannot be undone.')) return;\n    \n    // Delete all unsubmitted items for this bin\n    Promise.all(currentBinItems.map(item => \n        fetch(`${CONFIG.apiUrl}/bin-location-counts/${item.id}`, { method: 'DELETE' })\n    )).then(() => {\n        loadBinItems();\n    }).catch(error => {\n        alert(`‚ùå Error clearing items: ${error.message}`);\n    });\n}\nwindow.clearBinItems = clearBinItems;\n\nasync function submitBinLocation() {\n    if (!currentStockTake || !currentBinLocation) {\n        alert('Please scan a bin location first');\n        return;\n    }\n    \n    if (currentBinItems.length === 0) {\n        alert('Please add at least one item before submitting');\n        return;\n    }\n    \n    if (!confirm(`Submit ${currentBinItems.length} item(s) for bin location ${currentBinLocation.bin_code}?`)) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/bin-location-counts/${currentBinLocation.id}/submit`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                stock_take_id: currentStockTake.id,\n                counted_by_manager_id: currentStockTake.opened_by_manager_id\n            })\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to submit bin location');\n        }\n        \n        const data = await response.json();\n        alert(`‚úÖ Successfully submitted ${data.items_submitted} item(s) for bin location ${currentBinLocation.bin_code}!`);\n        \n        // Clear bin location and items\n        clearBinLocation();\n        \n        // Reload items in view tab\n        if (document.getElementById('viewTab').classList.contains('active')) {\n            loadItems();\n        }\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.submitBinLocation = submitBinLocation;\n\n// Check for active stock take when switching to stock take tab\nconst originalShowTab = showTab;\nshowTab = function(tabName, clickedElement) {\n    originalShowTab(tabName, clickedElement);\n    \n    if (tabName === 'stocktake') {\n        // Ensure variables are initialized\n        if (typeof currentStockTake === 'undefined') {\n            currentStockTake = null;\n        }\n        \n        // Update status display\n        updateStockTakeStatus();\n        \n        // Try to load active stock take if we have company/warehouse selected\n        const companyId = document.getElementById('openStockTakeCompany')?.value;\n        const warehouseId = document.getElementById('openStockTakeWarehouse')?.value;\n        \n        if (companyId && warehouseId) {\n            loadActiveStockTake(companyId, warehouseId);\n        }\n    }\n};\n\nasync function loadActiveStockTake(companyId, warehouseId) {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes/active?company_id=${companyId}&warehouse_id=${warehouseId}`);\n        \n        if (response.ok) {\n            const stockTake = await response.json();\n            if (stockTake) {\n                currentStockTake = stockTake;\n                updateStockTakeStatus();\n            }\n        }\n    } catch (error) {\n        console.error('Error loading active stock take:', error);\n    }\n}\n\n// ========== OPEN STOCK TAKES LIST ==========\nasync function loadOpenStockTakes() {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes?status=open`);\n        \n        if (!response.ok) throw new Error('Failed to load open stock takes');\n        \n        const openStockTakes = await response.json();\n        \n        const listEl = document.getElementById('openStockTakesList');\n        const noItemsEl = document.getElementById('noOpenStockTakes');\n        \n        if (listEl) {\n            if (openStockTakes.length === 0) {\n                listEl.innerHTML = '';\n                if (noItemsEl) noItemsEl.style.display = 'block';\n            } else {\n                if (noItemsEl) noItemsEl.style.display = 'none';\n                listEl.innerHTML = openStockTakes.map(st => `\n                    <div class=\"item-card\">\n                        <div class=\"item-header\">\n                            <h3>${escapeHtml(st.company_name)} - ${escapeHtml(st.warehouse_name)}</h3>\n                            <span class=\"item-id\">ID: ${st.id}</span>\n                        </div>\n                        <div class=\"item-details\">\n                            <div class=\"detail-item\"><strong>Company:</strong> ${escapeHtml(st.company_name)}</div>\n                            <div class=\"detail-item\"><strong>Warehouse:</strong> ${escapeHtml(st.warehouse_name)}</div>\n                            ${st.opened_by_name ? `<div class=\"detail-item\"><strong>Opened By:</strong> ${escapeHtml(st.opened_by_name)}</div>` : ''}\n                            <div class=\"detail-item\"><strong>Opened:</strong> ${formatDate(st.opened_at)}</div>\n                            ${st.notes ? `<div class=\"detail-item\"><strong>Notes:</strong> ${escapeHtml(st.notes)}</div>` : ''}\n                        </div>\n                        <div class=\"item-actions\">\n                            <button onclick=\"openExistingStockTake(${st.id})\" class=\"btn btn-small\">Open</button>\n                            <button onclick=\"closeStockTakeById(${st.id})\" class=\"btn btn-small btn-danger\">Close</button>\n                        </div>\n                    </div>\n                `).join('');\n            }\n        }\n    } catch (error) {\n        console.error('Error loading open stock takes:', error);\n        alert(`Error loading open stock takes: ${error.message}`);\n    }\n}\nwindow.loadOpenStockTakes = loadOpenStockTakes;\n\nasync function openExistingStockTake(stockTakeId) {\n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes/${stockTakeId}`);\n        \n        if (!response.ok) throw new Error('Failed to load stock take');\n        \n        const stockTake = await response.json();\n        currentStockTake = stockTake;\n        \n        // Set company and warehouse dropdowns\n        document.getElementById('openStockTakeCompany').value = stockTake.company_id;\n        document.getElementById('openStockTakeWarehouse').value = stockTake.warehouse_id;\n        updateWarehousesForOpenStockTake();\n        \n        updateStockTakeStatus();\n        showTab('stocktake');\n        \n        alert('‚úÖ Stock take loaded successfully!');\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.openExistingStockTake = openExistingStockTake;\n\nasync function closeStockTakeById(stockTakeId) {\n    if (!confirm('Are you sure you want to close this stock take?')) return;\n    \n    try {\n        const response = await fetch(`${CONFIG.apiUrl}/stock-takes/${stockTakeId}/close`, {\n            method: 'PUT'\n        });\n        \n        if (!response.ok) {\n            const error = await response.json();\n            throw new Error(error.error || 'Failed to close stock take');\n        }\n        \n        // If this was the current stock take, clear it\n        if (currentStockTake && currentStockTake.id === stockTakeId) {\n            currentStockTake = null;\n            currentBinLocation = null;\n            currentBinItems = [];\n            updateStockTakeStatus();\n            clearBinLocation();\n        }\n        \n        alert('‚úÖ Stock take closed successfully!');\n        loadOpenStockTakes();\n    } catch (error) {\n        alert(`‚ùå Error: ${error.message}`);\n    }\n}\nwindow.closeStockTakeById = closeStockTakeById;\n\n// ========== UTILITY FUNCTIONS ==========\nfunction formatDate(dateString) {\n    if (!dateString) return '';\n    try {\n        const date = new Date(dateString);\n        return date.toLocaleString();\n    } catch (e) {\n        return dateString;\n    }\n}\n\nfunction escapeHtml(text) {\n    if (!text) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\n// ========== QR CODE SCANNING ==========\nasync function startQRScan(inputId) {\n    // Stop any existing scanner\n    if (qrScanner) {\n        try {\n            await qrScanner.clear();\n        } catch (e) {\n            console.log('Clearing previous scanner');\n        }\n        qrScanner = null;\n    }\n\n    // Check if Html5Qrcode is available\n    if (typeof Html5Qrcode === 'undefined') {\n        alert('QR Code scanner library not loaded. Please refresh the page.');\n        return;\n    }\n\n    // Create modal for camera view\n    const modal = document.createElement('div');\n    modal.id = 'qrScannerModal';\n    modal.className = 'qr-scanner-modal';\n    modal.innerHTML = `\n        <div class=\"qr-scanner-content\">\n            <div class=\"qr-scanner-header\">\n                <h3>Scan QR Code</h3>\n                <button onclick=\"stopQRScan()\" class=\"btn btn-secondary\">‚úï Close</button>\n            </div>\n            <div id=\"qr-reader\" style=\"width: 100%;\"></div>\n            <p class=\"qr-hint\">Point your camera at the QR code</p>\n        </div>\n    `;\n    document.body.appendChild(modal);\n\n    // Initialize scanner\n    qrScanner = new Html5Qrcode(\"qr-reader\");\n    \n    try {\n        await qrScanner.start(\n            { facingMode: \"environment\" }, // Use back camera on mobile\n            {\n                fps: 10,\n                qrbox: { width: 250, height: 250 },\n                aspectRatio: 1.0\n            },\n            (decodedText, decodedResult) => {\n                // Successfully scanned\n                document.getElementById(inputId).value = decodedText;\n                stopQRScan();\n                \n                // Trigger the appropriate handler\n                if (inputId === 'counterBinLocationInput') {\n                    handleCounterBinLocationScan();\n                } else if (inputId === 'binLocationInput') {\n                    handleBinLocationScan();\n                } else if (inputId === 'itemCodeInput') {\n                    handleItemCodeScan();\n                }\n            },\n            (errorMessage) => {\n                // Ignore scanning errors (just keep trying)\n            }\n        );\n    } catch (err) {\n        console.error('Error starting QR scanner:', err);\n        alert('Failed to start camera. Please check permissions and try again.');\n        stopQRScan();\n    }\n}\nwindow.startQRScan = startQRScan;\n\nasync function stopQRScan() {\n    if (qrScanner) {\n        try {\n            await qrScanner.stop();\n            await qrScanner.clear();\n        } catch (e) {\n            console.log('Stopping scanner');\n        }\n        qrScanner = null;\n    }\n    \n    const modal = document.getElementById('qrScannerModal');\n    if (modal) {\n        modal.remove();\n    }\n}\nwindow.stopQRScan = stopQRScan;\n";

export const styleCss = "* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    min-height: 100vh;\n    padding: 20px;\n    color: #333;\n    margin: 0;\n}\n\n/* Role Selection Screen */\n.role-selection-screen {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    min-height: 100vh;\n    padding: 20px;\n}\n\n.role-selection-card {\n    background: white;\n    border-radius: 16px;\n    padding: 3rem;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n    max-width: 800px;\n    width: 100%;\n    text-align: center;\n}\n\n.role-selection-card h1 {\n    font-size: 2.5rem;\n    color: #667eea;\n    margin-bottom: 0.5rem;\n}\n\n.role-options {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 2rem;\n    margin-top: 3rem;\n}\n\n.role-option-btn {\n    background: white;\n    border: 3px solid #e0e0e0;\n    border-radius: 12px;\n    padding: 2rem;\n    cursor: pointer;\n    position: relative;\n    z-index: 1;\n    transition: all 0.3s;\n    text-align: center;\n}\n\n.role-option-btn:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n    border-color: #667eea;\n}\n\n.role-option-btn.counter-btn:hover {\n    border-color: #28a745;\n}\n\n.role-option-btn.manager-btn:hover {\n    border-color: #667eea;\n}\n\n.role-icon {\n    font-size: 4rem;\n    margin-bottom: 1rem;\n    pointer-events: none;\n}\n\n.role-option-btn h2 {\n    color: #333;\n    margin-bottom: 0.5rem;\n    font-size: 1.5rem;\n    pointer-events: none;\n}\n\n.role-option-btn p {\n    color: #666;\n    font-size: 0.95rem;\n    pointer-events: none;\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    background: white;\n    border-radius: 16px;\n    padding: 2rem;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n}\n\nheader {\n    text-align: center;\n    margin-bottom: 2rem;\n    padding-bottom: 1.5rem;\n    border-bottom: 2px solid #e0e0e0;\n}\n\nheader h1 {\n    font-size: 2.5rem;\n    color: #667eea;\n    margin-bottom: 0.5rem;\n}\n\n.subtitle {\n    color: #666;\n    font-size: 1.1rem;\n}\n\n/* Role Selector */\n.role-selector {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n    justify-content: center;\n    padding: 1rem;\n    background: #f8f9fa;\n    border-radius: 8px;\n}\n\n.role-btn {\n    padding: 0.75rem 2rem;\n    border: 2px solid #667eea;\n    background: white;\n    color: #667eea;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.role-btn:hover {\n    background: #f0f0f0;\n    transform: translateY(-2px);\n}\n\n.role-btn.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-color: #667eea;\n}\n\n/* Main Tabs */\n.tabs {\n    display: flex;\n    gap: 0.5rem;\n    margin-bottom: 2rem;\n    border-bottom: 2px solid #e0e0e0;\n}\n\n.tab-btn {\n    padding: 0.75rem 1.5rem;\n    border: none;\n    background: transparent;\n    color: #666;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    border-bottom: 3px solid transparent;\n    transition: all 0.3s;\n}\n\n.tab-btn:hover {\n    color: #667eea;\n    background: rgba(102, 126, 234, 0.1);\n}\n\n.tab-btn.active {\n    color: #667eea;\n    border-bottom-color: #667eea;\n}\n\n.tab-content {\n    display: none;\n}\n\n.tab-content.active {\n    display: block;\n}\n\n/* Setup Container */\n/* Company Selector Section */\n.company-selector-section {\n    background: #f8f9fa;\n    padding: 1.5rem;\n    border-radius: 8px;\n    margin-bottom: 2rem;\n    border: 2px solid #e0e0e0;\n}\n\n.selector-with-button {\n    display: flex;\n    gap: 1rem;\n    align-items: flex-end;\n}\n\n.selector-with-button .form-group {\n    flex: 1;\n}\n\n.selector-with-button .btn {\n    white-space: nowrap;\n}\n\n/* Setup Sections */\n.setup-section {\n    margin-bottom: 2rem;\n}\n\n.setup-subsection {\n    background: #f8f9fa;\n    padding: 1.5rem;\n    border-radius: 8px;\n    margin-bottom: 1.5rem;\n    border: 1px solid #e0e0e0;\n}\n\n.subsection-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n    padding-bottom: 0.75rem;\n    border-bottom: 2px solid #e0e0e0;\n}\n\n.subsection-header h3 {\n    color: #667eea;\n    font-size: 1.3rem;\n    margin: 0;\n}\n\n.btn-small {\n    padding: 0.5rem 1rem;\n    font-size: 0.9rem;\n}\n\n.setup-container {\n    width: 100%;\n}\n\n.setup-tabs {\n    display: flex;\n    gap: 0.5rem;\n    margin-bottom: 1.5rem;\n    border-bottom: 2px solid #e0e0e0;\n    flex-wrap: wrap;\n}\n\n.setup-tab-btn {\n    padding: 0.5rem 1rem;\n    border: none;\n    background: transparent;\n    color: #666;\n    font-size: 0.95rem;\n    font-weight: 600;\n    cursor: pointer;\n    border-bottom: 3px solid transparent;\n    transition: all 0.3s;\n}\n\n.setup-tab-btn:hover {\n    color: #667eea;\n    background: rgba(102, 126, 234, 0.1);\n}\n\n.setup-tab-btn.active {\n    color: #667eea;\n    border-bottom-color: #667eea;\n}\n\n.setup-content {\n    display: none;\n}\n\n.setup-content.active {\n    display: block;\n}\n\n.setup-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n}\n\n.setup-header h2 {\n    color: #333;\n    margin: 0;\n}\n\n/* Form Styles */\n.form-container {\n    max-width: 600px;\n    margin: 0 auto;\n}\n\n.form-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n    margin-bottom: 1rem;\n}\n\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-group label {\n    display: block;\n    margin-bottom: 0.5rem;\n    color: #333;\n    font-weight: 500;\n}\n\n.form-control {\n    width: 100%;\n    padding: 0.75rem;\n    border: 2px solid #e0e0e0;\n    border-radius: 8px;\n    font-size: 1rem;\n    transition: border-color 0.3s;\n    font-family: inherit;\n}\n\n.form-control:focus {\n    outline: none;\n    border-color: #667eea;\n}\n\ntextarea.form-control {\n    resize: vertical;\n    min-height: 80px;\n}\n\n.form-hint {\n    display: block;\n    margin-top: 0.25rem;\n    font-size: 0.85rem;\n    color: #666;\n    font-style: italic;\n}\n\n/* Filter Section */\n.filter-section {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n}\n\n.filter-box {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.filter-box label {\n    font-weight: 500;\n    color: #333;\n    font-size: 0.9rem;\n}\n\n.filter-box select {\n    padding: 0.5rem;\n    border: 2px solid #e0e0e0;\n    border-radius: 6px;\n    font-size: 0.95rem;\n}\n\n/* Buttons */\n.btn {\n    padding: 0.75rem 1.5rem;\n    border: none;\n    border-radius: 8px;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n}\n\n.btn-primary:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);\n}\n\n.btn-primary:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-secondary {\n    background: #6c757d;\n    color: white;\n}\n\n.btn-secondary:hover {\n    background: #5a6268;\n}\n\n.btn-small {\n    padding: 0.5rem 1rem;\n    font-size: 0.9rem;\n    background: #667eea;\n    color: white;\n}\n\n.btn-small:hover {\n    background: #5568d3;\n}\n\n.btn-danger {\n    background: #dc3545;\n}\n\n.btn-danger:hover {\n    background: #c82333;\n}\n\n.btn-success {\n    background: #28a745;\n    color: white;\n}\n\n.btn-success:hover {\n    background: #218838;\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);\n}\n\n.btn-link {\n    background: none;\n    border: none;\n    color: #667eea;\n    text-decoration: underline;\n    cursor: pointer;\n    padding: 0.5rem;\n    font-size: 0.9rem;\n}\n\n.btn-link:hover {\n    color: #764ba2;\n}\n\n.spinner {\n    display: inline-block;\n    animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n}\n\n.result-message {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    border-radius: 8px;\n    font-weight: 500;\n}\n\n.result-message.success {\n    background: #d4edda;\n    color: #155724;\n    border: 1px solid #c3e6cb;\n}\n\n.result-message.error {\n    background: #f8d7da;\n    color: #721c24;\n    border: 1px solid #f5c6cb;\n}\n\n/* Validation Messages */\n.validation-message {\n    margin-top: 1rem;\n    padding: 0.75rem 1rem;\n    border-radius: 6px;\n    font-size: 0.9rem;\n    font-weight: 500;\n}\n\n.validation-message.success {\n    background: #d4edda;\n    color: #155724;\n    border: 1px solid #c3e6cb;\n}\n\n.validation-message.error {\n    background: #f8d7da;\n    color: #721c24;\n    border: 1px solid #f5c6cb;\n}\n\n/* View Container */\n.view-container {\n    max-width: 100%;\n}\n\n.view-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n}\n\n.view-header h2 {\n    color: #333;\n}\n\n.search-box {\n    margin-bottom: 1rem;\n}\n\n.search-input {\n    width: 100%;\n    padding: 0.75rem;\n    border: 2px solid #e0e0e0;\n    border-radius: 8px;\n    font-size: 1rem;\n}\n\n.search-input:focus {\n    outline: none;\n    border-color: #667eea;\n}\n\n.loading {\n    text-align: center;\n    padding: 3rem;\n}\n\n.spinner {\n    border: 4px solid #f3f3f3;\n    border-top: 4px solid #667eea;\n    border-radius: 50%;\n    width: 50px;\n    height: 50px;\n    animation: spin 1s linear infinite;\n    margin: 0 auto 1rem;\n}\n\n.error {\n    background: #fee;\n    color: #c33;\n    padding: 1rem;\n    border-radius: 8px;\n    border: 1px solid #fcc;\n    margin-bottom: 1rem;\n}\n\n.items-container {\n    margin-top: 1rem;\n}\n\n.items-list {\n    display: grid;\n    gap: 1.5rem;\n}\n\n.item-card {\n    background: #f8f9fa;\n    border-radius: 12px;\n    padding: 1.5rem;\n    border-left: 4px solid #667eea;\n    transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.item-card:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n}\n\n.item-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.item-header h3 {\n    color: #333;\n    font-size: 1.3rem;\n    margin: 0;\n}\n\n.item-id {\n    color: #666;\n    font-size: 0.85rem;\n}\n\n.item-details {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 0.75rem;\n    margin-bottom: 1rem;\n}\n\n.detail-item {\n    color: #666;\n    font-size: 0.95rem;\n}\n\n.detail-item strong {\n    color: #333;\n    margin-right: 0.5rem;\n}\n\n.quantity-badge {\n    background: #667eea;\n    color: white;\n    padding: 0.25rem 0.75rem;\n    border-radius: 20px;\n    font-weight: 600;\n    font-size: 1.1rem;\n}\n\n.item-actions {\n    display: flex;\n    gap: 0.5rem;\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid #e0e0e0;\n}\n\n.no-items {\n    text-align: center;\n    padding: 3rem;\n    color: #666;\n    font-size: 1.1rem;\n}\n\n/* Modal Styles */\n.modal {\n    display: none;\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    justify-content: center;\n    align-items: center;\n}\n\n.modal-content {\n    background-color: white;\n    border-radius: 16px;\n    padding: 2rem;\n    max-width: 600px;\n    width: 90%;\n    max-height: 90vh;\n    overflow-y: auto;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);\n    position: relative;\n}\n\n.modal-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n    padding-bottom: 1rem;\n    border-bottom: 2px solid #e0e0e0;\n}\n\n.modal-header h2 {\n    margin: 0;\n    color: #333;\n}\n\n.modal-close {\n    background: none;\n    border: none;\n    font-size: 2rem;\n    color: #666;\n    cursor: pointer;\n    line-height: 1;\n    padding: 0;\n    width: 30px;\n    height: 30px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    transition: all 0.3s;\n}\n\n.modal-close:hover {\n    background: #f0f0f0;\n    color: #333;\n}\n\n.modal-actions {\n    display: flex;\n    gap: 1rem;\n    justify-content: flex-end;\n    margin-top: 1.5rem;\n    padding-top: 1.5rem;\n    border-top: 2px solid #e0e0e0;\n}\n\n@media (max-width: 768px) {\n    .container {\n        padding: 1rem;\n    }\n    \n    header h1 {\n        font-size: 2rem;\n    }\n    \n    .tabs {\n        flex-direction: column;\n    }\n    \n    .form-row {\n        grid-template-columns: 1fr;\n    }\n    \n    .filter-section {\n        grid-template-columns: 1fr;\n    }\n    \n    .view-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: stretch;\n    }\n    \n    .item-details {\n        grid-template-columns: 1fr;\n    }\n    \n    .item-actions {\n        flex-direction: column;\n    }\n    \n    .modal-content {\n        width: 95%;\n        padding: 1.5rem;\n    }\n    \n    .modal-actions {\n        flex-direction: column;\n    }\n    \n    .modal-actions .btn {\n        width: 100%;\n    }\n    \n    .setup-header {\n        flex-direction: column;\n        gap: 1rem;\n        align-items: stretch;\n    }\n}\n\n/* Scanning Interface Styles */\n.scanning-section {\n    background: #f8f9fa;\n    border: 2px solid #667eea;\n    border-radius: 12px;\n    padding: 2rem;\n    margin-top: 1.5rem;\n}\n\n.scanning-container {\n    max-width: 800px;\n    margin: 0 auto;\n}\n\n.scan-input-large {\n    margin-bottom: 1.5rem;\n}\n\n.scan-label {\n    font-size: 1.2rem;\n    font-weight: 600;\n    color: #333;\n    display: block;\n    margin-bottom: 0.5rem;\n}\n\n.scan-hint {\n    color: #666;\n    font-size: 0.9rem;\n    margin-bottom: 1rem;\n    font-style: italic;\n}\n\n.scan-input {\n    font-size: 1.2rem;\n    padding: 1rem;\n    border: 3px solid #667eea;\n    border-radius: 8px;\n    width: 100%;\n    margin-bottom: 1rem;\n}\n\n.scan-input:focus {\n    outline: none;\n    border-color: #764ba2;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);\n}\n\n.input-with-button-large {\n    display: flex;\n    gap: 1rem;\n    align-items: flex-start;\n}\n\n.input-with-button-large .scan-input {\n    flex: 1;\n    margin-bottom: 0;\n}\n\n.btn-large {\n    padding: 1rem 2rem;\n    font-size: 1.1rem;\n    min-width: 120px;\n}\n\n.button-group-center {\n    display: flex;\n    justify-content: center;\n    margin-top: 1.5rem;\n}\n\n.current-bin-box {\n    background: #d4edda;\n    border: 2px solid #28a745;\n    border-radius: 8px;\n    padding: 1rem;\n    margin-bottom: 1.5rem;\n}\n\n.current-bin-box h3 {\n    color: #155724;\n    margin-bottom: 0.5rem;\n}\n\n.current-bin-box p {\n    color: #155724;\n    margin: 0;\n}\n\n/* Start Counting Container */\n.start-counting-container {\n    text-align: center;\n    padding: 2rem;\n}\n\n.start-hint {\n    font-size: 1.2rem;\n    color: #666;\n    margin-bottom: 2rem;\n    font-weight: 500;\n}\n\n/* QR Scanner Modal */\n.qr-scanner-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.9);\n    z-index: 10000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.qr-scanner-content {\n    background: white;\n    border-radius: 12px;\n    padding: 2rem;\n    max-width: 90%;\n    max-height: 90%;\n    width: 500px;\n    text-align: center;\n}\n\n.qr-scanner-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n}\n\n.qr-scanner-header h3 {\n    margin: 0;\n    color: #333;\n}\n\n#qr-reader {\n    margin: 1rem 0;\n    border-radius: 8px;\n    overflow: hidden;\n}\n\n.qr-hint {\n    color: #666;\n    font-size: 0.9rem;\n    margin-top: 1rem;\n}\n\n/* Input with multiple buttons */\n.input-with-button-large {\n    display: flex;\n    gap: 0.5rem;\n    align-items: stretch;\n}\n\n.input-with-button-large .scan-input {\n    flex: 1;\n}\n\n.input-with-button-large .btn {\n    white-space: nowrap;\n    min-width: auto;\n    padding: 0.75rem 1rem;\n}\n\n.input-with-button-large .btn-secondary {\n    background: #6c757d;\n    color: white;\n    border: none;\n}\n\n.input-with-button-large .btn-secondary:hover {\n    background: #5a6268;\n}\n";
